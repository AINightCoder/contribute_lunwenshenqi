# Global Balance and Systemic Risk in Financial Correlation Networks

Paolo Bartesaghi $^ \mathrm { a }$ , Fernando Diaz-Diaz $^ \mathrm { b }$ , Rosanna Grass $\mathrm { a } , \ast$ , Pierpaolo Ubertia

aUniversity of Milano - Bicocca, Via Bicocca degli Arcimboldi 8, 20126 Milano, Italy $^ { b }$ Institute of Cross-Disciplinary Physics and Complex Systems, IFISC (UIB-CSIC), 07122 Palma de Mallorca, Spain

# Abstract

We show that the global balance index of financial correlation networks can be used as a systemic risk measure. We define the global balance of a network starting from a diffusive process that describes how the information spreads across nodes in a network, providing an alternative derivation to the usual combinatorial one. The steady state of this process is the solution of a linear system governed by the exponential of the replication matrix of the process. We provide a bridge between the numerical stability of this linear system, measured by the condition number in an opportune norm, and the structural predictability of the underlying signed network. The link between the condition number and related systemic risk measures, such as the market rank indicators, allows the global balance index to be interpreted as a new systemic risk measure. A comprehensive empirical application to real financial data finally confirms that the global balance index of the financial correlation network represents a valuable and effective systemic risk indicator.

Keywords: Networks, Signed networks, Global balance, Structural stability, Systemic risk measures

# 1. Introduction

The financial market is a striking example of a complex system that exhibits rich cooperative dynamics and collective behaviors. The correlation structure between the returns of different assets can change dramatically during major events such as crashes and bubbles. For example, during a crash, all stocks behave similarly, implying that the entire market acts as a single, highly synchronized community. On the contrary, during a bubble, a particular sector may over-perform, widening the gap between sectors or communities.

Starting from the 2008 global financial crisis, frequent and severe crises affected the economic system. This fact renewed the interest of practitioners and academicians for systemic risk measures. A unique definition of systemic risk is missing in the literature, probably for its complexity and for the multitude of potential triggering events: financial crises, sovereign debt crises, pandemics, wars and so on. Therefore, systemic risk has been studied from many different and alternative point of views: for example, [1] proposes a macroeconomic approach; [2] and [3] applies a network connectedness analysis; [4], [5], [6] and [7], among others, focus on conditional value at risk as a measure of systemic risk; and [8] investigates the inter-bank financial network as a source of systemic risk. An extensive review of the literature on the topic is behind the scope of the present research and for more details we refer, for instance, to [9], [10] and [11].

In [12], the authors introduce two econometric measures of systemic risk that capture the interconnectedness among the monthly returns of hedge funds, banks, brokers, and insurance companies. They implement principal components analysis and Granger causality tests for the purpose. Similar methodologies have been explored by [13] and [14]. Our contribution is framed in this context since we propose to interpret as a systemic risk measure an index computed from the matrix of returns correlations and based on the spectral properties of the corresponding network. The fact that our index depends on the eigenvalues of the correlation matrix overcomes the principal issue of the correlation, i.e. its intrinsic pairwise structure. This issue is underlined in [2], “Correlation-based measures remain widespread, yet they measure only pairwise association and are largely wed to linear, Gaussian thinking, making them of limited value in financial-market contexts.”

In the literature on financial networks, correlations are sometimes transformed into distances. The usual methodology is based on the nonlinear transformation $d ( i , j ) = \sqrt { 2 ( 1 - c _ { i j } ) }$ , introduced in [15], where $c _ { i j }$ is the Pearson correlation between $i$ and $j$ . Other distances have been proposed to overcome some drawbacks of the previous one, such as $d ( i , j ) = - \log c _ { i j } ^ { 2 }$ in [16]. While these transformations permit to construct weighted undirected networks and apply classical network theory tools, they fail to exploit the information contained in the correlation sign.

From a network theory perspective, if we do not employ the transformations mentioned above, the assets in a market (or in a portfolio) can be modeled as nodes, while pairs of assets are connected via edges with an associated weight $w _ { i j } \in [ - 1 , 1 ]$ , which corresponds to the Pearson correlation between them. The result is a signed, weighted, undirected network with self-loops. Importantly, the presence of negative weights creates novel phenomena that are absent in unsigned networks, like structural balance [17, 18]. A network is said to be structurally balanced if the nodes can be split into two subsets, such that connections between nodes of the same subset are positive and connections between nodes of different subsets are negative [17]. While perfect balance is a mathematical idealization, most empirical networks display statistical properties reminiscent of balanced networks [19, 20], like a high proportion of balanced triads [21]. Because of this, several balance indices have been proposed to measure how close a given network is to a structurally balanced one [22, 23, 20, 24, 19, 25]. The network balance significantly influences its dynamics across various models, including linear consensus [26], the voter model [27], synchronization [28], and contagion models [29, 30, 31]. It also plays a key role in the emergence of polarization in social systems [32, 25, 33, 34], compatibility of social relationships [35] and conflict in history [36].

The theory of signed networks [37] and their balance can provide interesting insight into the subtle relationship between predictability and overall systemic risk associated with groups of stocks or the entire network. A key insight, due to Harary, is that the level of structural balance impacts also on the performance of an investment portfolio. In fact, to the best of our knowledge, the first paper that or establishes a connection between signed networks and risk in financial networks is the one by Harary et al. [38]. In this paper, the authors address the question of how to design an effective hedging strategy for portfolio selection. They analyze the network of correlations between securities and conclude that a hedging strategy is effective, and thus the portfolio less risky, if there is at least one negative link and if the signed network is structurally balanced. However, the authors do not deal with systemic risk measures in the proper sense and do not study the relationship between these measures and structural balance indices. Indeed, the global balance index has never been interpreted as an indicator of systemic risk.

In this research, we show how to move from these structural indicators for signed networks to systemic risk measures as usually interpreted in the literature. The logical path of the paper can be described as follows. We start from a non-conservative diffusive process on networks governed by the adjacency matrix, interpreted as a replication matrix of the information transmitted by the nodes. We interpret the local version of the structural balance as a measure of the amount of information that leaves one node and returns to the same node when the diffusion process has reached a steady state. From the local measure we move to the global balance index, which is known and widely used in the literature to quantify structural balance in signed networks. Then, we show that this global indicator is naturally related to a ratio of the condition numbers of the two linear systems defining the steady state of the diffusive process on the signed network and on the corresponding unsigned network, that is the network with all positive edges. Thus, a natural bridge is created between the structural balance in correlation networks and a measure of the sensitivity of the network to an external perturbation of the state of the nodes. The link to known algebraic measures of conditioning provides the further connection to systemic risk measures. The condition number of the correlation matrix and some suitable generalizations called market rank indicators (MRI) have already been proposed in the literature as systemic risk measures (see [39]). We then compare the global balance of the signed correlation network with these systemic risk measures, which are part of the broader class of so-called proper measures of connectedness. This comparison leads us to explore the ability of the global balance to discriminate systemic events. Finally, we look at how such a global indicator performs as an effective measure of systemic risk, testing its performance on real financial data.

The paper is structured as follows: In Section 2 we recall the mathematical definitions. In Section 3 we show how the structural balance can be obtained from a discrete diffusive process on the network. In Section 4 we outline a conceptual path from the balance indices to systemic risk measures. In Section 5 we perform an empirical analysis to prove the effectiveness of the balance index as systemic risk measure. In Section 6 we draw conclusions and outlines for future research.

# 2. Preliminaries

We present first some preliminary notions on signed graphs and correlation networks.

# 2.1. Signed networks and structural balance

An undirected signed network is represented by a graph $G = ( V , E , \mathbf { W } )$ , where $V$ is the set of $N$ nodes, and $E$ is the set of undirected edges. The weighted signed adjacency matrix $\mathbf { W } = [ w _ { i j } ]$ of order $N \times N$ , with $w _ { i j } \in \mathbb { R }$ , encodes all the adjacency relationships within the nodes. Specifically, $w _ { i j } \neq 0$ if there is an edge between nodes $_ i$ and $j$ , $w _ { i j } = 0$ otherwise. Edge weights are positive or negative depending on the nature of the relationship between the pair of nodes. It may relate to activating or inhibiting functions in biological systems ([40]), trusting or distrusting links in social or political networks ([41]), cooperative or antagonistic relationships in economic settings ([42]), correlated and anticorrelated behavior in the time series of asset returns in the financial context ([43]). A binary adjacency matrix $\mathbf { A } = \left[ a _ { i j } \right]$ can be associated with the signed network $G$ by setting all non-null weights equal to $1$ or $^ { - 1 }$ according to the sign of the entries . In $a _ { i j }$ the paper we will also need to refer to the underlying unsigned network, that is the graph obtained from $G$ by neglecting the edges sign. The matrices associated with this network are $| \mathbf { W } |$ and $| \mathbf { A } |$ . The strength of a node $i$ , in the signed network, is then defined as $s _ { i } = \textstyle \sum _ { j } | w _ { i j } |$ and the degree as $\begin{array} { r } { d _ { i } = \sum _ { j } | a _ { i j } | } \end{array}$ .

A signed graph $G$ is structurally balanced if there are no negative cycles, that is, cycles with an odd number of negative edges (see [17, 18]). A balanced network is characterized by the balance theorem as a graph containing a bipartition of the vertex set $V$ such that every edge between the two subsets is negative, while every edge within each subset is positive (see [17]).

A signed graph $G$ is called antibalanced if $- G$ is balanced, that is, if the graph with opposite edge signs with respect to $G$ is balanced (see [44]). An antibalanced graph does not contain cycles with an odd number of positive edges, that is all even cycles are positive and all odd cycles are negative. Equivalently, there is a bipartition of $V$ into two subsets, such that an edge is positive if and only if it has its endpoints in different subsets (see [44, 45]).

Finally, a signed graph $G$ is strictly unbalanced if $G$ is neither balanced nor antibalanced. Structural balance can also be framed in terms of closed walks instead of cycles. In a network, a walk is a sequence of vertices where each adjacent pair is connected by an edge, and a closed walk is a walk that starts and ends at the same vertex. The sign of a walk is the product of the signs of its edges. Unlike cycles, closed walks can revisit vertices and edges, making them simpler to compute. Indeed, while enumerating cycles is an NP-complete problem, the enumeration of walks can be solved in a polynomial time by computing the powers of the adjacency matrix. Thus, by utilizing closed walks, the analysis of structural balance becomes more computationally efficient. The use of walks also provides connections to the theory of random walks and Markov chains, as we prove in the next sections.

# 2.2. Correlation networks from asset returns

Let us consider the time series of the log-returns of $N$ assets represented by the random variables $X _ { i t } =$ $\log { \frac { P _ { i , t + 1 } } { P _ { i , t } } }$ , where $P _ { i , t }$ is the price at time $t$ , and the corresponding standardized variables $\ddot { X } _ { i t }$ , with $i = 1 , . . . , N$ and $t = 1 , . . . , T$ . The matrix of standardized returns $\tilde { \mathbf { X } } \in \mathbb { R } ^ { N \times T }$ is:

$$
\tilde { \bf X } = \left[ \begin{array} { c c c c } { \tilde { X } _ { 1 1 } } & { \tilde { X } _ { 1 2 } } & { . . . } & { \tilde { X } _ { 1 T } } \\ { . } & { \vdots } & { \vdots } & { . } \\ { \tilde { X } _ { N 1 } } & { \tilde { X } _ { N 2 } } & { . . . } & { \tilde { X } _ { N T } } \end{array} \right] .
$$

Since the rows of $\tilde { \mathbf { X } }$ are standardized, the correlation matrix is $\mathbf { C } = \textstyle \frac { 1 } { T } \tilde { \mathbf { X } } \tilde { \mathbf { X } } ^ { T }$ .

We denote by $( \lambda _ { i } , \phi _ { \mathbf { i } } )$ , $i = 1 \ldots N$ , the eigenpairs of the matrix $\mathbf { C }$ . Recall that $\sqrt { T \cdot \lambda _ { i } }$ are the singular values of the matrix $\tilde { \mathbf { X } }$ , and the number of nonzero singular values of $\tilde { \mathbf { X } }$ defines its rank. Since correlations are inherently signed, neglecting the diagonal elements – that are all equal to ${ \mathrm { ~ 1 ~ - ~ t ~ } }$ he matrix $\mathbf { C }$ can be viewed as the weighted adjacency matrix of a signed network $G _ { C } = ( V , E , \mathbf { C } )$ , where the nodes are the assets and the signed weighted edges are the correlations between them. We will call $G _ { C }$ the correspondent correlation network.

# 3. From dynamics to balance indices

Our aim is to quantify the level of reliability and structural predictability of the network and derive the local and global balance indices in an original way. We start from a discrete non-Markovian non-conservative diffusive process on the network. This process is then applied to the correlation network where, thanks to the features of the correlation matrix, it is possible to prove some important properties on the stability of the related dynamical problem.

# 3.1. A non-conservative information diffusion process on signed networks

In [46] the authors propose a dynamical process based on the stochastic transition matrix for two walkers of opposite sign and nature. Conversely, we propose a non-Markovian non-conservative diffusion process based on the adjacency matrix A. We note that signed networks are useful for the study of non-conservative processes, as the presence of negative connections typically causes standard dynamics like linear consensus to become non-conservative (see [26]).

We assume that the state of a node in the network is described by a variable that can take positive or negative values. A high absolute value of this variable reflects a high information content. A positive (negative) value on a node is interpreted as a favorable (unfavorable) information content for that node. An edge transfers its information between the two incident nodes. Negative edges flip the sign of walkers crossing them, while their sign remains unchanged when crossing positive edges. In other words, a positive walker becomes negative after crossing a negative edge, and is received by the destination node as the opposite of that in the source node, while it preserves its sign when crossing a positive edge. For instance, in a correlation network, if a piece of information is favorable to a given security, it remains favorable to all the positive correlated securities and it becomes unfavorable to the securities negatively correlated with the former. On the opposite, if a piece of information is unfavorable to a given security, it remains unfavorable to all the positively correlated securities, while it becomes favorable to the securities negatively correlated. An overall neutral information content on a node is represented by a state equal to zero. In general, although we refer to a discrete time process, the state variable on each node is assumed to be continuous.

Given these premises, two possible non-conservative diffusion processes can be designed. In the first process, a node replicates and transfers its entire information content to all its neighbors. In the second one, the node does not transfer its entire information content, but only the information received in the previous step of the process.

Let $x _ { i } ( t )$ be the information content of node $_ i$ at a discrete time $t \geq 0$ . In the first case, when the node transmits all its content to its neighbors, the process is described by the recursive relation $x _ { i } ( t ) =$ $\begin{array} { r } { x _ { i } ( t - 1 ) + \sum _ { j = 1 } ^ { N } A _ { i j } x _ { j } ( t - 1 ) } \end{array}$ , and the state vector ${ \bf x } ( t )$ evolves according to $\mathbf { x } ( t ) = \mathbf { x } ( t - 1 ) + \mathbf { A } \mathbf { x } ( t - 1 )$ . The adjacency matrix $\mathbf { A }$ , called replication matrix in the framework of diffusive processes, captures how the original information is copied and transferred from node $i$ to node $j$ . In a discrete setting, this process produces a new configuration of the whole network at the time step $t$ , given by $\mathbf { x } ( t ) = ( \mathbf { I } + \mathbf { A } ) ^ { t } \mathbf { x } _ { 0 }$ , where $\mathbf { x } _ { 0 }$ is the initial state vector.

In the process described above, a node retains its own information and diffuses all its content to its neighbors. More interestingly, let us suppose that, at time $t$ , a node retains all what it has received up to time $t - 1$ from its neighbors and it does not transmit its entire information content but only the portion just received from its neighbors in the previous step $t - 1$ . In words, the node does not share all that its information content but only the part that it just learned from its neighbors. This is because what it knew before has already been sent in the previous steps of the diffusion process. Moreover, to ensure a higher generality, we assume that one node transmits only a fraction $\alpha ( t )$ ( $0 < \alpha ( t ) \le 1$ ) of what received. In summary, the dynamics is expressed by the following iterative relation, for $t \geq 0$ ,

$$
x _ { i } ( t + 1 ) = x _ { i } ( t ) + \alpha ( t ) \sum _ { j = 1 } ^ { N } A _ { i j } \left[ x _ { j } ( t ) - x _ { j } ( t - 1 ) \right]
$$

where $x _ { i } ( - 1 ) \equiv 0$ and $\alpha ( t )$ is the penalization factor. Setting $\Delta { \mathbf x } ( t ) = { \mathbf x } ( t ) - { \mathbf x } ( t - 1 )$ , and rewriting in matrix form, it equals

$$
\Delta \mathbf { x } ( t + 1 ) = \alpha ( t ) \mathbf { A } \Delta \mathbf { x } ( t )
$$

where $\Delta { \bf x } ( 0 ) = { \bf x } ( 0 ) = { \bf x } _ { 0 }$ . Simple computations show that Eq. (3) is equivalent to ${ \bf x } ( t ) = { \bf x } ( t - 1 ) +$ $\left( \prod _ { k = 0 } ^ { t - 1 } \alpha ( k ) \right) \mathbf { A } ^ { t } \mathbf { x } _ { 0 }$ . This allows to express the state vector ${ \bf x } ( t )$ at time $t$ in terms of the initial state vector $\mathbf { x } _ { \mathrm { 0 } }$ as

$$
{ \bf x } ( t ) = { \bf G } ( t ) { \bf x } _ { 0 }
$$

where the matrix function $\mathbf G ( t )$ is

$$
\mathbf { G } ( t ) = \mathbf { I } + \sum _ { \tau = 1 } ^ { t } \left( \prod _ { k = 0 } ^ { \tau - 1 } \alpha ( k ) \right) \mathbf { A } ^ { \tau } .
$$

In particular, by setting $\textstyle \alpha ( k ) = { \frac { 1 } { k + 1 } }$ , for $k \geq 0$ , the matrix function becomes $\begin{array} { r } { \mathbf { G } ( t ) = \sum _ { \tau = 0 } ^ { t } \frac { 1 } { \tau ! } \mathbf { A } ^ { \tau } } \end{array}$ , so that

$$
\mathbf { x } ( t ) = \left[ \sum _ { \tau = 0 } ^ { t } \frac { 1 } { \tau ! } \mathbf { A } ^ { \tau } \right] \mathbf { x } _ { 0 } .
$$

Since $\begin{array} { r } { \operatorname* { l i m } _ { t  \infty } \mathbf { G } ( t ) = e ^ { \mathbf { A } } } \end{array}$ , the asymptotic state is

$$
\begin{array} { r } { { \bf x } _ { \infty } = e ^ { { \bf A } } { \bf x } _ { 0 } . } \end{array}
$$

Remark 1. The above derivation provides an alternative interpretation of the exponential operator. In the literature (see [36]), the exponential operator usually measures the information diffusion in a Markovian context at $t = 1$ . We have shown that the same operator can also be interpreted as the equilibrium distribution of a non-Markovian process. This overcomes the issue of arbitrary tuning the time parameter at $t = 1$ .

# 3.2. Balance indices

Let us consider the process in Eq. (5). We assume that the diffusion starts from a single node in the network. Let us set $\mathbf { x } _ { 0 } = \mathbf { e } _ { i }$ , where $\mathbf { e _ { i } }$ is the $i - t h$ vector of the standard basis in $\mathbb { R } ^ { N }$ . Then the asymptotic state is

$$
\begin{array} { r } { { \bf x } _ { \infty } = [ e ^ { { \bf A } } ] _ { i } , } \end{array}
$$

where $[ e ^ { \mathbf { A } } ] _ { i }$ denotes the $i -$ th column of the exponential matrix. The amount of information originating from node $i$ that returns to the same node after the diffusion process and reaches a steady state is then given by the diagonal element

$$
x _ { \infty , i } = [ e ^ { \mathbf { A } } ] _ { i i } .
$$

This description does not depend on the sign of the weights and can be repeated for both the matrices $\mathbf { A }$ and $| \mathbf { A } |$ . Due to the presence of signed edges, the amount of information lost in a non-conservative diffusion process through the network can be measured by

$$
\kappa _ { i } ( G ) : = \frac { [ e ^ { \mathbf { A } } ] _ { i i } } { [ e ^ { | \mathbf { A } | } ] _ { i i } } .
$$

This quantity is called local balance of the node $_ i$ and has been introduced in [36] by both a combinatoric perspective and a diffusive approach based on the Lerman-Gosh Laplacian [47]. In this context, it compares the fraction of information originating from $_ i$ that comes back to $i$ in the actual network and in the balanced versions of the same network. Equivalently, the numerator in Eq. (9) represents the polarization (see [46]) at each node, defined as the difference between the number of positive and negative walkers; the denominator is the total number of walkers coming back to that node.1

Definition 1. The global balance index of the network is obtained by summing the contributions of all nodes:

$$
\kappa ( G ) = \frac { \sum _ { i = 1 } ^ { N } [ e ^ { \mathbf { A } } ] _ { i i } } { \sum _ { i = 1 } ^ { N } [ e ^ { | \mathbf { A } | } ] _ { i i } } = \frac { \mathrm { t r } [ e ^ { \mathbf { A } } ] } { \mathrm { t r } [ e ^ { | \mathbf { A } | } ] } = \frac { \sum _ { i = 1 } ^ { N } e ^ { \lambda _ { i } } } { \sum _ { i = 1 } ^ { N } e ^ { \sum _ { i } } }
$$

where $\lambda _ { i }$ and $\overline { { \lambda } } _ { i }$ are respectively the eigenvalues of $\mathbf { A }$ and $| \mathbf { A } |$ .

Let us recall the Acharya’s theorem (see [48]), which proves that $\mathbf { A }$ and $| \mathbf { A } |$ have the same spectrum if and only if the network is balanced. Hence, a network is balanced if and only if $\kappa _ { i } ( G ) = 1 , \forall i$ , or, equivalently, $\kappa ( G ) = 1$ (see [36]).

Finally, we observe that the above result still holds if we replace the binary matrix A with the weighted matrix $\mathbf { W }$ . Moreover, the presence of identical loops in the network does not affect the computation of the balance indices. In other words, if the diagonal elements of the matrix are all equal, they do not contribute to the global balance, as shown in the following proposition.

Proposition 1. Let $\mathbf { A }$ be a square matrix with real, possibly negative, entries and diagonal elements equal to $\chi \in \mathbb R$ . Let ${ \ddot { \mathbf { A } } } = \mathbf { A } - \chi \mathbf { I }$ , where $\mathbf { I }$ is the identity matrix, and $G$ and $\tilde { G }$ the corresponding graphs. Then $\kappa _ { v } ( G ) = \kappa _ { v } ( \tilde { G } )$ .

Proof.

$$
\kappa _ { v } ( G ) : = \frac { [ e ^ { \mathbf { A } } ] _ { v v } } { [ e ^ { | \mathbf { A } | } ] _ { v v } } = \frac { [ e ^ { \tilde { \mathbf { A } } + \chi \mathbf { I } } ] _ { v v } } { [ e ^ { | \tilde { \mathbf { A } } | + \chi \mathbf { I } } ] _ { v v } } = \frac { [ e ^ { \tilde { \mathbf { A } } } \cdot e ^ { \chi \mathbf { I } } ] _ { v v } } { [ e ^ { | \tilde { \mathbf { A } } | } \cdot e ^ { \chi \mathbf { I } } ] _ { v v } } = \frac { [ e ^ { \tilde { \mathbf { A } } } ] _ { v v } } { [ e ^ { | \tilde { \mathbf { A } } | } ] _ { v v } } = \kappa _ { v } ( \tilde { G } )
$$

This result allows us to apply the described process to a correlation network $G _ { c }$ , using the correlation matrix $\mathbf { C }$ , with diagonal elements $\chi = 1$ , as the replication matrix.

# 4. From balance indices to systemic risk measures

We now present the conceptual path from the illustrated balance indices to systemic risk measures on correlation networks. The first step is an assessment on the structural predictability of the diffusion model as a function of the signed network on which it operates. The second step is an analysis of the conditioning of the linear problem associated with the asymptotic state. This will naturally unveil a connection between the balance indices and a class of systemic risk measures, the market rank indicators, which fall within the broader set of so-called proper measures of connectedness.

4.1. Interpretation of the balance indices in terms of network structural reliability/predictability

We aim to highlight a crucial aspect of network balance, which is related to the degree of structural predictability of the dynamic processes occurring in the network and to the reliability of the latter in transmitting information. It is widely accepted that structurally balanced networks make the behavior of the dynamics largely predictable (see [46]). In particular, we discuss how the notion of structural predictability should be interpreted. We begin by considering the toy examples of three and four nodes, whose modeling signed graphs can be exhaustively listed (see Fig. 4.1).

![](images/317a80727a3b3d70fd43c2191112e1aa758648cbf6f50292648e78cac691a03b.jpg)  
$K _ { 4 }$ unbalanced   
Figure 4.1: All possible $K _ { 3 }$ and $K _ { 4 }$ signed graphs, up to isomorphism. In the first line, balanced triangles, (a) and (c), and unbalanced triangles, (b) and (d). In the second line, the three balanced $K _ { 4 }$ graphs. In the third and fourth line, the eight unbalanced $K _ { 4 }$ graphs, among which (e), (g) and (k) are antibalanced and the others are strictly unbalanced.

With three nodes, four complete signed graphs $K _ { 3 }$ are possible. The monotone answer of one node can be uniquely decided from that of the other two in the balanced triangles (a) and (c) in Fig. 4.1, first line, while this is not possible in the unbalanced triangles (b) and (d). In fact, in the last two cases, starting from the behavior of a node, however the triangle is traversed, it leads to the opposite behavior at the same node, showing the inherent instability and unpredictability of the structure.

To reinforce this idea, let us consider the case of a complete signed graph of four nodes. Three of them are balanced, namely (a), (b) and (c), see Fig. 4.1, second line. The other eight are unbalanced, see the third and the fourth line in Fig. 4.1; more precisely, three are antibalanced, (e), (g) and (k), and the remaining are strictly unbalanced.

For each graph, we apply the non-conservative model in Eq. (5). We refer, for instance, to the four nodes graphs (b), (f), (k) and we compare their behavior with the fully positive graph (a).

Example 1. Suppose each node is in an initial state represented by the value of its attribute or endowment at time $t = 0$ . Graph $K _ { 4 }$ (b) is balanced, so that $\kappa ( G ) = 1$ . If node 1 increases its attribute, nodes 2 and 4 increase their own attributes as well, and the attribute of node 3 can only decrease. For instance, starting from an initial uniform state $\mathbf { x } _ { 0 } = [ 1 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , the asymptotic state is $\mathbf { x } _ { \infty } = [ 1 0 . 2 2 7 , 1 0 . 2 2 7 , - 9 . 4 9 1 , 1 0 . 2 2 7 ] ^ { T }$ . If we increase by 1 unit the state of node 1, that is $\mathbf { x } _ { 0 } = [ 2 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , we get $\mathbf { x } _ { \infty } = [ 1 5 . 5 2 4 , 1 5 . 1 5 6 , - 1 4 . 4 2 0 , 1 5 . 1 5 6 ] ^ { I }$ . Note that, in this case, the local balance of each node is $\kappa _ { i } ( G ) = 1 , \forall i = 1 , 2 , 3 , 4$ .

Example 2. We now focus on graph $K _ { 4 }$ , (f) that is strictly unbalanced with $\kappa ( G ) = 0 . 5 9 2$ . If node 1 increases its attribute, nodes 2 and 4 should increase their attribute. Now, however, node 3 should both increase its state due to its connection with node 1 and decrease its state due to the effect of its connections with nodes 2 and 4. Suppose again that the initial state is ${ \bf x } _ { 0 } = [ 1 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , so that the asymptotic state is $\mathbf { x } _ { \infty } = [ 6 . 8 5 5 , 6 . 8 0 0 , - 1 . 4 1 8 , 6 . 8 0 0 , ] ^ { T }$ . If the attribute of node 1 increases, for instance with $\mathbf { x } _ { 0 } = [ 1 8 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , the final asymptotic state becomes $\mathbf { x } _ { \infty } = [ 5 2 . 5 9 9 , 4 1 . 9 6 1 , - 0 . 9 5 2 , 4 1 . 9 6 1 ] ^ { T }$ , and the state of node 3 increases by an amount of 0.466. If, on the other hand, along with that of node 1, the state of nodes 2 and 4 also increases slightly, for example starting from an initial state of $\mathbf { x } _ { 0 } = [ 2 0 , 1 . 2 , 1 , 1 . 2 ] ^ { \scriptscriptstyle T }$ , we obtain $\mathbf { x } _ { \infty } = [ 5 8 . 8 0 8 , 4 7 . 4 5 7 , - 1 . 7 2 4 , 4 7 . 4 5 7 ] ^ { T }$ . The state of node 3 decreases. In this case, the local balance of the nodes are $\kappa _ { 1 } ( G ) = \kappa _ { 3 } ( G ) = 0 . 5 0 8$ and $\kappa _ { 2 } ( G ) = \kappa _ { 4 } ( G ) = 0 . 6 7 7$ . Thus nodes 1 and 3 contribute to unbalance the network more than nodes 2 and 4.

Example 3. Graph $K _ { 4 }$ , (k) is a complete graph with all negative edges and so it is the most unbalanced in the set, with $\kappa ( G ) = 0 . 3 8 7$ . As expected, if node 1 increases its attribute, all the other nodes have the opposite behavior. For instance, starting from $\mathbf { x } _ { 0 } = [ 1 . 2 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , the final state becomes $\mathbf { x } _ { \infty } =$ $[ 0 . 4 6 0 , - 0 . 0 8 4 , - 0 . 0 8 4 , - 0 . 0 8 4 ] ^ { T }$ . However, we can make node 3 increase its state while increasing the state value of node 1 even more by acting on the state values of nodes 2 and 4. For example, by reducing them as in the initial state $\mathbf { x } _ { 0 } = [ 1 . 4 , 0 . 7 , 1 , 0 . 7 ] ^ { \scriptscriptstyle T }$ , we obtain $\mathbf { x } _ { \infty } = [ 1 . 2 7 1 , - 0 . 6 3 2 , 0 . 1 8 3 , - 0 . 6 3 2 ] ^ { T }$ .

These toy examples illustrate two important points. First, even within a fully deterministic diffusive model, the response of a node to state perturbations of at least two other nodes exhibits non-monotonic behaviors in an unbalanced network. Second, in a balanced network, there is a more pronounced dependence on the fluctuations in the attributes of some nodes than in an unbalanced network.

# 4.2. Global balance and condition number

We show how the global balance of the network is related to the condition number of the matrix $e ^ { \mathbf { A } }$ . Specifically, we prove that the global balance can be used as an indicator of the conditioning of the linear system $\mathbf { x } _ { \infty } = e ^ { \mathbf { A } } \mathbf { x } _ { 0 }$ .

Let us start with a preliminary observation. As in the toy examples in Sec. 4.1, we perturb the initial state $\mathbf { x } _ { \mathrm { 0 } }$ at node $i$ as follows:

$$
\begin{array} { r } { \mathbf { x } _ { 0 } ^ { \star } = \mathbf { x } _ { 0 } + \varepsilon \mathbf { e } _ { i } , \varepsilon \in \mathbb { R } . } \end{array}
$$

The asymptotic state of the diffusive model becomes

$$
\begin{array} { r } { \mathbf { x } _ { \infty } ^ { \star } = \mathbf { x } _ { \infty } + \varepsilon [ e ^ { \mathbf { A } } ] _ { i } . } \end{array}
$$

In particular, the $i -$ th component of $\mathbf { x } _ { \infty } ^ { \star }$ is:

$$
x _ { \infty , i } ^ { \star } = x _ { \infty , i } + \varepsilon [ e ^ { \mathbf { A } } ] _ { i i } .
$$

The diagonal element $[ e ^ { \mathbf { A } } ] _ { i i }$ measures how a perturbation of the initial state at node $i$ is amplified in the final state of the same node. Therefore, the local balance $\kappa _ { i } ( G )$ of node $_ i$ , defined in Eq. (9), quantifies how less effective the propagation of the perturbation starting from node $i$ is in the signed network, compared to the same perturbation from the same node propagating in the unsigned network.

In general, in the linear problem $\mathbf { x } _ { \infty } = e ^ { \mathbf { A } } \mathbf { x } _ { 0 }$ , let us perturb the initial state $\mathbf { x } _ { 0 }$ and evaluate the effect on the asymptotic state $\mathbf { x } _ { \infty }$ . This is equivalent to considering the inverse problem $e ^ { - \mathbf { A } } \mathbf { x } _ { \infty } = \mathbf { x } _ { 0 }$ and quantifying the variation in the solution $\mathbf { x } _ { \infty }$ due to a perturbation on $\mathbf { x } _ { \mathrm { 0 } }$ . Let $\mathbf { e } \in \mathbb { R } ^ { n }$ be the general error or perturbation on $\mathbf { x } _ { 0 }$ . Then the condition number $\mathcal { K }$ of the linear problem is the ratio between the relative errors in $\mathbf { x } _ { \infty }$ and in $\mathbf { x } _ { 0 }$ (see, for instance, [49]):

$$
{ \mathcal { H } } ( e ^ { - \mathbf { A } } ) = \operatorname* { l i m } _ { \varepsilon \to 0 } \operatorname* { s u p } _ { | | \mathbf { e } | | < \varepsilon } { \frac { | | e ^ { \mathbf { A } } \mathbf { e } | | } { | | \mathbf { e } | | } } { \frac { | | \mathbf { x } _ { 0 } | | } { | | e ^ { \mathbf { A } } \mathbf { x } _ { 0 } | | } } = | | e ^ { - \mathbf { A } } | | \cdot | | e ^ { \mathbf { A } } | | ,
$$

where $| | \cdot | |$ is any matrix norm. In particular, using the trace norm (Schatten $p -$ norm with $p = 1$ ), it can be expressed as

$$
\mathcal { H } ( e ^ { - \mathbf { A } } ) = \left( \sum _ { j = 1 } ^ { N } e ^ { - \lambda _ { j } } \right) \left( \sum _ { j = 1 } ^ { N } e ^ { \lambda _ { j } } \right) .
$$

We are interested in studying the ratio between the condition numbers of the exponential matrices $e ^ { \mathbf { A } }$ and $e ^ { | \mathbf { A } | }$ , that is

$$
\mathcal { R } ( \mathbf { A } ) = \frac { \mathcal { H } ( e ^ { - \mathbf { A } } ) } { \mathcal { H } ( e ^ { - | \mathbf { A } | } ) } .
$$

In particular, we aim to discriminate when $\mathcal { R } ( { \bf A } )$ is greater or less than 1. In fact, if $\mathcal { R } ( \mathbf { A } ) < 1$ , the linear system in Eq. (6) on the signed network is better conditioned than the same system on the unsigned network, and vice versa if $\mathcal { R } ( \mathbf { A } ) > 1$ . This determines the different response of the nodes to perturbations propagating within the network in the two versions, signed and unsigned, of the network. We also show that $\mathcal { R } ( { \bf A } )$ is tightly related to the global balance $\kappa ( G )$ in Eq. (10) and, under some further assumptions, the time series of their values in a time-evolving network are highly correlated (see Sec. 5). We start with the following

Proposition 2. The ratio $\mathcal { R } ( { \bf A } )$ between the condition numbers of the matrices $e ^ { - \mathbf { A } }$ and $e ^ { - | \mathbf { A } | }$ , in the Schatten $p -$ norm with $p = 1$ , can be expressed as a function of the global balances of the networks $G$ , $- G$ and $- | G |$ as

$$
{ \mathcal { R } } ( \mathbf { A } ) = { \frac { \kappa ( G ) \cdot \kappa ( - G ) } { \kappa ( - | G | ) } }
$$

where $- G$ is obtained by flipping the signs of all the edges in $G$ , and $- | G |$ is the fully negative network.

Proof. From Eqs. (10) and (15), we have

$$
{ \mathcal { R } } ( \mathbf { A } ) = { \frac { \operatorname { t r } [ e ^ { \mathbf { A } } ] \cdot \operatorname { t r } [ e ^ { - \mathbf { A } } ] } { \operatorname { t r } [ e ^ { | \mathbf { A } | } ] \cdot \operatorname { t r } [ e ^ { - | \mathbf { A } | } ] } } = { \frac { { \frac { \operatorname { t r } [ e ^ { \mathbf { A } } ] } { \operatorname { t r } [ e ^ { | \mathbf { A } | } ] } } \cdot { \frac { \operatorname { t r } [ e ^ { - \mathbf { A } } ] } { \operatorname { t r } [ e ^ { | \mathbf { A } | } ] } } } { \frac { \operatorname { t r } [ e ^ { - | \mathbf { A } | } ] } { \operatorname { t r } [ e ^ { | \mathbf { A } | } ] } } } = { \frac { \kappa ( G ) \cdot \kappa ( - G ) } { \kappa ( - | G | ) } } .
$$

Proposition 2 shows that the ratio of the two condition numbers is closely related to the global balance of the network $G$ , also through the global balances of the networks associated with it, namely $- G$ and $- | G |$ .

We now prove a necessary condition for $\kappa ( G ) = 1$ . First, observe that if $G$ is balanced, namely $\kappa ( G ) = 1$ , both $- G$ and $- | G |$ are antibalanced. Actually, we do not know whether they are balanced or not, that is, we can only say that $\kappa ( - G ) \leq 1$ and $\kappa ( - | G | ) \leq 1$ . Nevertheless, the following result holds.

Proposition 3. If $G$ is a balanced or antibalanced signed network, then $\mathcal { R } ( \mathbf { A } ) = 1$ .

Proof. First recall that, in general, the $i j$ - element of the $k$ power of the adjacency matrix returns the number of signed walks between nodes $_ i$ and $j$ , that is the difference between the number of positive and negative walks of length positive (negati $k$ . Moreover, a closed we). Then observe that edge sig, where $\begin{array} { r } { \mathrm { t r } [ e ^ { \mathbf { A } } ] = \sum _ { i = 1 } ^ { N } [ \sum _ { k } \frac { 1 } { k ! } \mathbf { A } ^ { k } ] _ { i i } = \sum _ { i = 1 } ^ { N } [ \sum _ { k } \frac { 1 } { k ! } ( W _ { k , i } ^ { + } - W _ { k , i } ^ { - } ) ] } \end{array}$ $W _ { k , i } ^ { \pm }$ is the number (weight) of positive and negative closed walks, respectively, of length $k$ starting from node $i \in V$ and ending at the same node. Then $\begin{array} { r } { \mathrm { t r } [ e ^ { \mathbf { A } } ] = \sum _ { k } \frac { 1 } { k ! } ( \sum _ { i = 1 } ^ { N } W _ { k , i } ^ { + } - \sum _ { i = 1 } ^ { N } W _ { k , i } ^ { - } ) = \sum _ { k } \frac { 1 } { k ! } ( W _ { k } ^ { + } - W _ { k } ^ { - } ) } \end{array}$ where $W _ { k } ^ { \pm }$ is the total number (weight) of positive and negative walks of length $k$ starting from any node and ending at the same node, summed over all the nodes in the network $G$ . Similarly, for the network $| G |$ we have $\begin{array} { r } { \operatorname { t r } [ e ^ { | \mathbf { A } | } ] = \sum _ { k } \frac { 1 } { k ! } ( W _ { k } ^ { + } + W _ { k } ^ { - } ) } \end{array}$ . Therefore:

$$
\begin{array} { r l } { \mathcal { H } ( \mathbf { A } ) = \frac { | \mathbf { T } | ( \rho _ { \mathrm { A } } ^ { \mathrm { A } } ) | } { | \mathbf { T } | ( \rho _ { \mathrm { A } } ^ { \mathrm { A } } ) | } + \frac { | \mathbf { T } | ( \rho _ { \mathrm { A } } ^ { \mathrm { A } } ) | } { | \mathbf { A } ^ { \mathrm { A } } | } = \frac { | \mathbf { T } | | \mathbf { A } _ { \mathrm { A } } ^ { \mathrm { A } } | | \cdot | \mathbf { T } | | \mathbf { A } _ { \mathrm { B } } ^ { \mathrm { A } } | ^ { \mathrm { A } } - | \mathbf { A } _ { \mathrm { B } } ^ { \mathrm { A } } | ^ { \mathrm { B } } | } { | \mathbf { A } ^ { \mathrm { A } } | ^ { \mathrm { B } } \cdot | \mathbf { T } | | \mathbf { A } _ { \mathrm { B } } ^ { \mathrm { A } } | ^ { \mathrm { B } } + | \mathbf { A } _ { \mathrm { B } } ^ { \mathrm { A } } | ^ { \mathrm { B } } | } } \\  = \frac { \sum _ { \mathbf { A } } \frac { \frac { 1 } { \rho _ { \mathrm { A } } } ^ { \mathrm { B } } } { \rho _ { \mathrm { A } } ^ { \mathrm { A } } } | \mathbf { W } _ { \mathbf { A } } ^ { \mathrm { A } } - \mathbf { W } _ { \mathbf { A } } ^ { \mathrm { A } } | ^ { \mathrm { B } } \cdot \sum _ { \mathbf { A } } \frac { \frac { 1 } { \rho _ { \mathrm { A } } ^ { \mathrm { A } } } | \mathbf { W } _ { \mathbf { A } } ^ { \mathrm { A } } - \mathbf { W } _ { \mathbf { A } } ^ { \mathrm { A } } | } { | \mathbf { A } ^ { \mathrm { B } } | ^ { \mathrm { B } } + | \mathbf { W } _ { \mathbf { A } } ^ { \mathrm { B } } | ^ { \mathrm { B } } } } \\  =  \end{array}
$$

where $W _ { \mathrm { e v e n } } ^ { \pm }$ and $W _ { \mathrm { o d d } } ^ { \pm }$ denote the total penalized number (weight) of positive and negative closed walks of even and odd length, respectively. For a balanced graph, by definition, there are no negative closed walks and $W _ { \mathrm { e v e n } } ^ { - } = W _ { \mathrm { o d d } } ^ { - } = 0$ . For an antibalanced graph, by definition, every even closed walk is positive and every odd closed walk is negative, so $W _ { \mathrm { e v e n } } ^ { - } = W _ { \mathrm { o d d } } ^ { + } = 0$ . The claim follows. □

We conjecture that Proposition 3 can also be extended to a sufficient condition, that is: If $\mathcal { R } ( \mathbf { A } ) = 1$ then $G$ is a balanced or antibalanced signed network.2

Observe that the previous Proposition expresses the ratio $\mathcal { R } ( { \bf A } )$ as a function of the properties of the network $G$ , namely through the penalized number or weight of even/odd and positive/negative closed walks in $G$ . In the next Remark we highlight the explicit expression of these four types of closed walks.

Remark 2. The penalized weight of even/odd and positive/negative closed walks in a signed network $G$ can be expressed as

$$
\begin{array} { l } { { \displaystyle { \cal W } _ { \mathrm { e v e n } } ^ { \pm } = \mathrm { t r } \left( \cosh | { \bf A } | \pm \cosh { \bf A } \right) = \sum _ { i = 1 } ^ { N } \left( \cosh \overline { { { \lambda } } } _ { i } \pm \cosh \lambda _ { i } \right) } } \\ { { \displaystyle { \cal W } _ { \mathrm { o d d } } ^ { \pm } = \mathrm { t r } \left( \sinh | { \bf A } | \pm \sinh { \bf A } \right) = \sum _ { i = 1 } ^ { N } \left( \sinh \overline { { { \lambda } } } _ { i } \pm \sinh \lambda _ { i } \right) } } \end{array}
$$

Remark 3. By Eq. (18), it follows immediately that $W _ { \mathrm { e v e n } } ^ { + } > W _ { \mathrm { e v e n } } ^ { - }$ and $W _ { \mathrm { e v e n } } ^ { + } > W _ { \mathrm { o d d } } ^ { + }$ for any signed network. In words, weighted positive even closed walks always prevail on the even negative and odd positive ones.

Definition 2. A signed graph such that $W _ { \mathrm { e v e n } } ^ { + } \cdot W _ { \mathrm { e v e n } } ^ { - } > W _ { \mathrm { o d d } } ^ { + } \cdot W _ { \mathrm { o d d } } ^ { - }$ is said even-dominant and a signed graph such that $W _ { \mathrm { e v e n } } ^ { + } \cdot W _ { \mathrm { e v e n } } ^ { - } < W _ { \mathrm { o d d } } ^ { + } \cdot W _ { \mathrm { o d d } } ^ { - }$ is said odd-dominant.

We now show that $\mathcal { R } ( { \bf A } )$ is greater or less than 1 according to the fact that the signed graph is evendominant or odd-dominant.

Proposition 4. Let $\mathcal { R } ( { \bf A } )$ be the ratio between the condition numbers of the two matrices $e ^ { - \mathbf { A } }$ and $e ^ { - | \mathbf { A } | }$ , in the Schatten $p -$ norm with $p = 1$ . $\mathcal { R } ( \mathbf { A } ) < 1$ if and only if the matrix $\mathbf { A }$ is the adjacency matrix of a strictly unbalanced even-dominant signed network $G$ . $\mathcal { R } ( \mathbf { A } ) > 1$ if and only if the matrix $\mathbf { A }$ is the adjacency matrix of a strictly unbalanced odd-dominant signed network $G$ .

Proof. We prove the claim for an even-dominant signed network. The odd-dominant case follows analogously. By expanding the ratio, we observe that:

$$
\mathcal { R } ( \mathbf { A } ) = \frac { \left[ W _ { \mathrm { e v e n } } ^ { + } - W _ { \mathrm { e v e n } } ^ { - } \right] ^ { 2 } - \left[ W _ { \mathrm { o d d } } ^ { + } - W _ { \mathrm { o d d } } ^ { - } \right] ^ { 2 } } { \left[ W _ { \mathrm { e v e n } } ^ { + } + W _ { \mathrm { e v e n } } ^ { - } \right] ^ { 2 } - \left[ W _ { \mathrm { o d d } } ^ { + } + W _ { \mathrm { o d d } } ^ { - } \right] ^ { 2 } } < 1
$$

if and only if $W _ { \mathrm { e v e n } } ^ { + } \cdot W _ { \mathrm { e v e n } } ^ { - } - W _ { \mathrm { o d d } } ^ { + } \cdot W _ { \mathrm { o d d } } ^ { - } > 0$

Proposition 2 shows the close relation between the ratio of the condition numbers in the signed and unsigned networks and the balance of the network $G$ and its related networks $- G$ , $| G |$ and $- | G |$ . Proposition

3 proves that, if the network $G$ is balanced or antibalanced, the conditioning of the linear problem in Eq. (6) is the same in the signed network and in its underlying unsigned network. Proposition 4 shows that this ratio can be both less or greater than 1 depending on the topological properties of the network, in particular on the dominance of even closed walks or odd closed walks. Propositions 3 and 4 together provide an almost complete classification of the signed graphs based on the value of the ratio in Eq. (19). If $\mathcal { R } ( \mathbf { A } ) < 1$ the graph is even-dominant strictly unbalanced; if $\mathcal { R } ( \mathbf { A } ) > 1$ the graph is odd-dominant strictly unbalanced; if the graph is balanced or antibalanced, $\mathcal { R } ( \mathbf { A } ) = 1$ .

# 4.3. Approximating Global Balance and Condition Numbers in Correlation Networks

We now show that the ratio $\mathcal { R } ( { \bf A } )$ is more typically less than 1 for a large set of significant matrices, in particular for the empirical correlation matrices we are interested in. We assume from now on that the matrix $\mathbf { A }$ is positive semidefinite so that all its eigenvalues $\lambda _ { i }$ are nonnegative: $0 \le \lambda _ { N } \le \lambda _ { N - 1 } \le \cdot \cdot \cdot \le \lambda _ { 2 } \le \lambda _ { 1 }$ . We refer to $\lambda _ { 1 }$ as the spectral radius and to $\lambda _ { 1 } - \lambda _ { 2 }$ as the spectral gap.

We first express $\mathcal { R } ( { \bf A } )$ as a function of the intervals between pairs of eigenvalues, as shown in the following.

Proposition 5. The ratio $\mathcal { R } ( { \bf A } )$ between the condition numbers of the matrices $e ^ { - \mathbf { A } }$ and $e ^ { - | \mathbf { A } | }$ , in the Schatten $p -$ norm with $p = 1$ , can be expressed as

$$
{ \mathcal { R } } ( \mathbf { A } ) = { \frac { \left( \sum _ { i = 1 } ^ { N } e ^ { - \lambda _ { i } } \right) \left( \sum _ { i = 1 } ^ { N } e ^ { \lambda _ { i } } \right) } { \left( \sum _ { i = 1 } ^ { N } e ^ { - { \overline { { \lambda } } } _ { i } } \right) \left( \sum _ { i = 1 } ^ { N } e ^ { { \overline { { \lambda } } } _ { i } } \right) } } = { \frac { 1 + { \frac { 2 } { N } } \sum _ { j < i } \cosh ( \lambda _ { i } - \lambda _ { j } ) } { 1 + { \frac { 2 } { N } } \sum _ { j < i } \cosh ( { \overline { { \lambda } } } _ { i } - { \overline { { \lambda } } } _ { j } ) } }
$$

where $\lambda _ { N } \le \lambda _ { N - 1 } \le \cdot \cdot \cdot \le \lambda _ { 1 }$ and $\overline { { { \lambda } } } _ { N } \le \overline { { { \lambda } } } _ { N - 1 } \le \cdots \le \overline { { { \lambda } } } _ { 1 }$ are the eigenvalues of $\mathbf { A }$ and $| \mathbf { A } |$ , and $\cosh ( \cdot )$ denotes the hyperbolic cosin function.

Proof. The statement immediately follows from $\begin{array} { r } { \left( \sum _ { i = 1 } ^ { N } e ^ { - \lambda _ { i } } \right) \left( \sum _ { i = 1 } ^ { N } e ^ { \lambda _ { i } } \right) = N + 2 \sum _ { j < i } \cosh ( \lambda _ { i } - \lambda _ { j } ) } \end{array}$

Proposition 5 emphasizes the dependence of $\mathcal { R } ( { \bf A } )$ on the intervals $\Delta \lambda _ { i j } = \lambda _ { i } - \lambda _ { j }$ between pairs of eigenvalues. It highlights the relevant role of the spectral gap in large correlation networks based on the correlation matrix $\mathbf { C }$ .

Remark 4. In the presence of a large spectral gap for both the signed and unsigned networks, that is if $\Delta \lambda _ { 1 j } \gg \Delta \lambda _ { i j } , 2 < i , j \le N$ , and similarly for the $\overline { { \lambda } } _ { i }$ ’s, the ratio $\mathcal { R } ( { \bf A } )$ can be expressed in the approximated form

$$
\mathcal { R } ( { \bf A } ) \approx \frac { N + 2 \sum _ { j = 2 } ^ { N } \cosh \Delta \lambda _ { 1 j } } { N + 2 \sum _ { j = 2 } ^ { N } \cosh \Delta \overline { { \lambda } } _ { 1 j } } \approx \frac { N + 2 ( N - 1 ) \cosh \lambda _ { 1 } } { N + 2 ( N - 1 ) \cosh \overline { { \lambda } } _ { 1 } } \approx \frac { e ^ { \lambda _ { 1 } } } { e ^ { \overline { { \lambda } } _ { 1 } } }
$$

In general, for any signed network, the inequality $\lambda _ { 1 } ~ \leq ~ \overline { { \lambda } } _ { 1 }$ holds. The spectral radius of the matrix A is strictly smaller than that of the matrix $| \mathbf { A } |$ if and only if the signed network $G$ is strictly unbalanced, that is neither balanced nor antibalanced, i.e. $\lambda _ { 1 } < \overline { { \lambda } } _ { 1 }$ if and only if $G$ is strictly unbalanced (see [46], Theorem 3.9, and [50]). This implies that the approximated value in Eq. (20) is less than 1 for strictly unbalanced networks. Let us observe that, since $\textstyle \sum _ { j = 2 } ^ { N } \lambda _ { j } \ = \ N - \lambda _ { 1 }$ and $\textstyle \sum _ { j = 2 } ^ { N } { \overline { { \lambda } } } _ { j } \ = \ N - { \overline { { \lambda } } } _ { 1 }$ , we have $\begin{array} { r } { \sum _ { j = 2 } ^ { N } \Delta \lambda _ { 1 j } = N ( \lambda _ { 1 } - 1 ) < N ( \overline { { \lambda } } _ { 1 } - 1 ) = \sum _ { j = 2 } ^ { N } \Delta \overline { { \lambda } } _ { 1 j } } \end{array}$ , but this does not guarantees that $\Delta \lambda _ { 1 j } < \Delta \bar { \lambda } _ { 1 j }$ , $\forall j$ . However, if $\lambda _ { 1 } \gg \lambda _ { j }$ and $\overline { { \lambda } } _ { 1 } \gg \overline { { \lambda } } _ { j }$ , for $j = 2 , \dots , N$ , we can also assume $\Delta \lambda _ { 1 j } \approx \lambda _ { 1 }$ and $\Delta \bar { \lambda } _ { 1 j } \approx \bar { \lambda } _ { 1 }$ . This justifies the second approximation in Eq. (20). As a further consequence of the same equation, we can conclude that for correlation networks with large spectral gap the value of the ratio $\mathcal { R } ( { \bf A } )$ can be approximated with the value of the global balance $\kappa ( G )$ , that is ${ \mathcal { R } } ( \mathbf { A } ) \approx \kappa ( G )$ . This effectiveness of the approximation is confirmed by the results in the empirical analysis.

Remark 4 shows that, in general, when dealing with correlation networks, the conditioning of the linear system in Eq. (6) is better on the signed correlation network than on the corresponding unsigned correlation network. The correlation matrices, when interpreted as adjacency matrices of a signed graph, are usually even-dominant.

Our interpretation of this result is that the presence of negative edges, that is negative correlations, mitigates the propagation of a perturbation shock within the network. Therefore, an unbalanced graph can mitigate and absorb the perturbations from one node better than a balanced graph. In a strictly unbalanced graph, we expect that the oscillations produced by a single node cannot be amplified to a large extent due to the lower condition number of the adjacency matrix. Conversely, in a balanced graph, where there are two disjoint communities and all closed walks are positive, a perturbation originating from one node is amplified travelling through the network. This result shows that a balanced graph is more unstable and sensitive than an unbalanced one and, at the same time, it is more reliable in transmitting information. This supports the interpretation of network global balance in terms of reliability in transmitting information, as discussed in subsection 4.1. We conclude this section with a numerical example.

Example 4. Consider the following randomly generated correlation matrix with $N = 4$ :

$$
A = \left[ \begin{array} { c c c c } { { 1 } } & { { 0 . 7 6 4 4 2 7 3 7 } } & { { 0 . 3 3 5 3 1 1 3 7 } } & { { 0 . 2 3 5 6 3 2 5 } } \\ { { 0 . 7 6 4 4 2 7 3 7 } } & { { 1 } } & { { 0 . 0 5 1 3 7 4 7 9 } } & { { - 0 . 3 4 9 0 9 3 3 } } \\ { { 0 . 3 3 5 3 1 1 3 7 } } & { { 0 . 0 5 1 3 7 4 7 9 } } & { { 1 } } & { { 0 . 7 3 4 8 3 4 8 } } \\ { { 0 . 2 3 5 6 3 2 5 } } & { { - 0 . 3 4 9 0 9 3 3 } } & { { 0 . 7 3 4 8 3 4 8 } } & { { 1 } } \end{array} \right] .
$$

The network associated with this correlation matrix is a weighted version of the graph $K _ { 4 }$ (d) in Fig. 4.1, third line. It is a strictly unbalanced network and its global balance is $\kappa ( G ) = 0 . 9 6 1 6 9 9 1$ . The local balances of the four nodes are collected in the vector $| 0 . 9 5 9 6 1 0 2 , 0 . 9 5 1 9 6 6 7 , 0 . 9 8 3 2 8 6 7 , 0 . 9 5 2 6 1 2 3 |$ ].

Let us first note that by increasing the initial state $\mathbf { x } _ { 0 } = [ 1 , 1 , 1 , 1 ] ^ { \scriptscriptstyle T }$ , for example, by the error $\varepsilon \mathbf { e } _ { 1 }$ with $\varepsilon = 2$ , the increase in the asymptotic state of node 1, that is $\mathbf { x } _ { \infty , 1 } ^ { \star } - \mathbf { x } _ { \infty , 1 } = \varepsilon [ e ^ { \mathbf { A } } ] _ { 1 1 }$ , is equal to 7.640996 for the signed network and to 7.962604 for the unsigned network. The difference for a unitary error, equal to $[ e ^ { | \mathbf { A } | } ] _ { 1 1 } - [ e ^ { \mathbf { A } } ] _ { 1 1 } = 0 . 1 6 0 8 0 4$ , increases linearly with $\varepsilon$ and the ratio $[ e ^ { \mathbf { A } } ] _ { 1 1 } / [ e ^ { | \mathbf { A } | } ] _ { 1 1 } = 0 . 9 5 9 6 1 0 2$ is exactly the local balance of node 1. The eigenvalues of $\mathbf { A }$ are $\lambda _ { 1 } = 1 . 9 5 6 2 7 0 7 7$ $\lambda _ { 2 } = 1 . 7 0 4 6 4 3 2 1$ . $\lambda _ { 3 } = 0 . 3 1 6 6 7 0 4 6$ and $\lambda _ { 4 } = 0 . 0 2 2 4 1 5 5 7$ , while the eigenvalues of $| \mathbf { A } |$ are $\overline { { \lambda } } _ { 1 } = 2 . 2 3 9 4 9 4 7 1$ $\overline { { \lambda } } _ { 2 } = 1 . 2 7 4 0 0 2 4 4$ . $\overline { { \lambda } } _ { 3 } = 0 . 4 3 9 2 4 2 6 8$ and $\lambda _ { 4 } = 0 . 0 4 7 2 6 0 1 8$ . The two exact condition numbers are $\mathcal { H } ( e ^ { - \mathbf { A } } ) = 3 0 . 3 7 8 5 2$ and $\mathcal { H } ( e ^ { - | \mathbf { A } | } ) = 3 0 . 8 8 7 3 9$ , and their exact ratio is therefore $\mathcal { R } ( { \bf A } ) = 0 . 9 8 3 5 2 5 1$ . For such a low-dimensional correlation matrix, the difference between the two condition numbers is small. Nevertheless it evidences the fact that the balanced network shows a greater dependence on the initial data than the unbalanced network.

This numerical example can be extended to a statistical analysis of the relationship between the global balance $\kappa ( G )$ of the network $G$ and the ratio of the two condition numbers $\mathcal { R } ( { \bf A } )$ in the case of randomly generated correlation matrices. We refer to the Appendix A for further details.

# 4.4. Interpretation in terms of systemic risk measure

The close relationship between global balance and condition number proved in the previous sections prompts further the comparison toward indicators that generalize the condition number of the correlation matrix in the context of systemic risk.

The information contained in the eigenvalues of the correlation matrix can be used to define systemic risk measures associated with the underlying dataset. Two classes of indicators have been identified in the literature, the first exploiting the information contained in the larger eigenvalues and, the second, the information content of the smaller eigenvalues. The two classes provide alternative views on systemic risk.

The first looks at the greatest eigenvalues to study the process of synchronization among the $N$ variables of interest. The eigenvalues of the covariance (or correlation) matrix $\mathbf { C }$ can be viewed as the amount of variance that is explained by the corresponding eigenvectors. In fact, if $\phi _ { i }$ represents the normalized eigenvector associated with the eigenvalue $\lambda _ { i }$ , then the following equalities hold:

$$
\lambda _ { i } = \lambda _ { i } \phi _ { i } ^ { T } \phi _ { i } = \phi _ { i } ^ { T } \mathbf { C } \phi _ { i } = \frac { 1 } { T } \phi _ { i } ^ { T } \tilde { \mathbf { X } } \tilde { \mathbf { X } } ^ { T } \phi _ { i } = \frac { 1 } { T } \left( \phi _ { i } ^ { T } \tilde { \mathbf { X } } \right) \left( \phi _ { i } ^ { T } \tilde { \mathbf { X } } \right) ^ { T } = \mathrm { V a r } \left( \phi _ { i } ^ { T } \tilde { \mathbf { X } } \right) .
$$

Eq. (22) shows that $\lambda _ { i }$ represents the portion of the total variance associated with the $_ { i - t h }$ principal portfolio $\phi _ { i }$ , derived from PCA analysis, as defined in [51]. Each component $\lambda _ { i } \phi _ { i } \phi _ { i } ^ { T }$ represents a new portfolio out of the original stocks, which is orthogonal with the others. Then the corresponding eigenvalue measures its contribution to the total risk.

In particular, if all the empirical eigenvalues are lower than the upper bound defined by the MarchenkoPastur law (see [52]), then the common components tracking the empirical data are not statistically different from those generated by a random process, and we can conclude that there is no structural correlation and no synchronization among the variables. Conversely, when some of the largest eigenvalues exceed the upper bound, they represent common drivers that convey information about the covariance structure of the empirical data better than what a null random matrix model could do.

Specifically, if the total risk of the system is represented by $\begin{array} { r } { \sum _ { i = 1 } ^ { N } \lambda _ { i } = \operatorname { t r } \mathbf { C } = N } \end{array}$ , the fraction of the total risk associated with the first $M$ principal components, the so-called Cumulative Risk Fraction (CRF) or Absorption Rate, is defined as $\begin{array} { r } { C R F = \sum _ { i = 1 } ^ { M } \lambda _ { i } / \sum _ { i = 1 } ^ { N } \lambda _ { i } = \frac { 1 } { N } \sum _ { i = 1 } ^ { M } \lambda _ { i } } \end{array}$ (see [12]). As a consequence, when the system is highly interconnected, $M$ out of the $N$ principal components can explain most of the volatility in the system.

The second approach focuses on the eigenvalues $\lambda _ { i } , i = 1 , \ldots , N$ , as they represent the approximation of the algebraic distances of the empirical observations matrix $\tilde { \mathbf { X } }$ from the subspace of rank deficient matrices. In particular, $\lambda _ { N } \leq . . . \leq \lambda _ { 2 } \leq \lambda _ { 1 }$ give the distances between $\tilde { \mathbf { X } }$ and the closest rank deficient matrices with ranks $N - 1 , \ldots , 1 , 0$ , respectively. Therefore, if the eigenvalues $\lambda _ { i }$ are small, and so are the singular values of $\tilde { \mathbf { X } }$ , then the distances of the $\tilde { \mathbf { X } }$ matrix from the rank deficient matrices are small. A short distance from the rank deficient matrices corresponds to a high numerical linear dependence between the assets. A high numerical linear dependence is equivalent to a reduced number of diversification opportunities for the investor and, hence, a higher risk. The class of indicators that best captures this aspect in terms of minimum distances and thus minimum eigenvalues is that of the Market Rank Indicators (MRI) (see [39]). We refer here to a possible realization of these indicators, specifically to the arithmetic version of the Market Rank

Indicator (AMRI) defined in terms of power mean as

$$
A M R I = \frac { \lambda _ { 1 } } { \left( \frac { 1 } { H } \sum _ { i = N - H + 1 } ^ { N } \lambda _ { i } ^ { p } \right) ^ { 1 / p } }
$$

where $1 \leq H \leq N$ and $p \in \mathbb N$ . Note that the AMRI reduces to the condition number in norm 2, $\lambda _ { 1 } / \lambda _ { N }$ , for $H \ = \ 1$ . This measure has been shown to belong to the broad class of so-called proper measures of connectedness ([53]) and have been used to empirically analyze financial datasets in [54].3

The local and global balance indices introduced in Eqs. (9) and (10) are defined in a way completely independent of both the class of systemic risk measures based on the larger eigenvalues and the class based on the smaller eigenvalues, since they imply a comparison between the correlation matrix and its entry-wise absolute value.

However, the interpretation proposed in the previous sections suggests that a bridge can be established between the domain of balance in signed networks and the domain of systemic risk measures for asset correlation networks. Indeed, the relationship of the balance index with the condition numbers of the diffusion problem and with the ratio $\mathcal { R } ( { \bf A } )$ defined in Eq. (16) indicates that they are candidates to be indicators of systemic risk as a relative measure of the effect of correlation signs on the spread of information in the underlying network.4 As a consequence, they can be used to detect the greater or lesser stability/sensitivity of the portfolio behavior with respect to the maximum stability/sensitivity associated with the balanced one, which typically has a higher condition number and, consequently, are less diversified and more exposed to systemic risk. At this point, we now want to explore the ability of this new indicator to reveal systemic events on empirical correlation networks and compare its capabilities with that of other known measures in the literature.

# 5. Empirical analysis

We test the results of Sections 3 and 4 on two different databases. We focus the analysis on the weighted version of the correlation-based signed network. However, we also compare the results with the binary network. The binarization is obtained by applying a standard threshold chosen in the interval $( 0 , 1 )$ ; above the threshold, the correlations are set equal to 1, below the corresponding opposite value, the correlations are set equal to $^ { - 1 }$ , and are $0$ in the remaining cases. The binary network loses the values of the edge weights, making the behavior of the correlations sharper and more extreme. The chosen threshold is 0.25.

The weighted and the binary signed correlation networks are constructed over $\Delta T$ -days windows, rolling at $\Delta t$ -days step. Then the returns are split by using $\Delta t$ -days stepped windows of $\Delta T$ -days width and the data from each window are used to construct the correlation matrix of that window. The appropriate choice of $\Delta T$ is a critical point when using eigenvalue-based indicators, since a full rank correlation matrix is required.

# 5.1. Comparison between the Global Balance and the Market Rank Indicator

The first database contains the daily returns of the stocks of the S&P500 index, from January 4, 2005 to March 18, 2020. The number of assets is 385, smaller than the nominal one, since we limited our analysis to the stocks with a complete time series on the whole period. The entire dataset spans $T = 4 1 0 9$ days.

We start with a direct comparison between the behavior of the Global Balance and that of some systemic risk indicators. The time windows width is $\Delta T = 4 0 0$ days and a step of $\Delta t = 3 0$ days is applied. We note that $\Delta T$ is larger than the number of assets; this permits to calculate the eigenvalue-based indicators. Fig. 5.1 shows the temporal evolution of the Global Balance $\kappa ( G )$ and of the average correlation. In Fig 5.1, panels (a) and (b), we have split the entire interval into two sub-intervals, 2005-2016 and 2016-2020, to highlight with higher resolution the information carried by the indicators in the two periods. In Fig. 5.1 panel (c), we zoom in on the period 2008-2014, when the global balance undergoes small relative changes.

The correlation between the two time series is, in general, high. The Pearson correlation is equal to $\rho _ { \mathrm { P e a r s o n } } = 0 . 5 9 0 2 0 9 3$ , while rank correlation is equal to $\rho _ { \mathrm { S p e a r m a n } } = 0 . 8 7 7 1 3 7 5$ .

We also compare the behaviors of the global balance and of the market rank indicator, as shown in Fig. 5.2. Fig. 5.2, panel (a), represents the temporal evolution of the global balance (black line) and of the market rank indicator (blue, red, and green line) over the interval January 2005-October 2016. The three plots for the market rank indicator refer to different choices of the number of smaller eigenvalues used for its computation: the blue line refers to 10 minimum eigenvalues, the red line to 50 and the green line to 100. Similarly, in panel (b), for the period November 2016-January 2020. In the definition of MRI, we have assumed $p = 3$ in the power mean used in the denominator (see Eq. (23)). The correlations between the global balance and the MRI for the two intervals and for the different parameters are listed in Table 5.1. Observe that we have added in the Table the case $H = N = 3 8 5$ that returns the cumulative risk fraction indicator (see [12]).

<table><tr><td rowspan=2 colspan=1></td><td rowspan=1 colspan=4>Correlations between Global balance and MRI</td></tr><tr><td rowspan=1 colspan=2>2005-2016</td><td rowspan=1 colspan=2>2016-2020</td></tr><tr><td rowspan=1 colspan=1>H</td><td rowspan=1 colspan=1>Pearson</td><td rowspan=1 colspan=1>Spearman</td><td rowspan=1 colspan=1>Pearson</td><td rowspan=1 colspan=1>Spearman</td></tr><tr><td rowspan=1 colspan=1>10</td><td rowspan=1 colspan=1>0.51043890</td><td rowspan=1 colspan=1>0.75268360</td><td rowspan=1 colspan=1>0.65198390</td><td rowspan=1 colspan=1>0.81116310</td></tr><tr><td rowspan=1 colspan=1>50</td><td rowspan=1 colspan=1>0.53938464</td><td rowspan=1 colspan=1>0.81110470</td><td rowspan=1 colspan=1>0.65998890</td><td rowspan=1 colspan=1>0.90441180</td></tr><tr><td rowspan=1 colspan=1>100</td><td rowspan=1 colspan=1>0.55415830</td><td rowspan=1 colspan=1>0.82765060</td><td rowspan=1 colspan=1>0.65877970</td><td rowspan=1 colspan=1>0.89204550</td></tr><tr><td rowspan=1 colspan=1>385</td><td rowspan=1 colspan=1>0.87786900</td><td rowspan=1 colspan=1>0.89459170</td><td rowspan=1 colspan=1>0.88014410</td><td rowspan=1 colspan=1>0.98061500</td></tr></table>

Table 5.1: Correlations between Global balance and MRI in the two intervals 2005-2016 and 2016-2020, for different values of $H$ in the definition of the MRI.

As expected, these correlations do not change dramatically if we use a different value of $p$ in the definition of MRI: for instance, for the weighted version, for $p = 4$ and $H = 1 0$ we get $\rho _ { \mathrm { P e a r s o n } } = 0 . 5 0 9 6 7 1 3$ and $\rho _ { \mathrm { S p e a r m a n } } = 0 . 7 5 0 0 6 5 9$ . Similarly for other values of $p$ and $k$ .

![](images/3629679de2498711e31d1f391109d206c8edea5c514111f378f1ff8490303b84.jpg)  
Figure 5.1: Global Balance (square dots black line) and Average Correlation (circular dots red lines), S&P500 daily returns, $\Delta T = 4 0 0$ and $\Delta t = 3 0$ , for the period (a) 2005-2016, (b) 2016-2020 and (c) zoom on the period 2008-2014.

![](images/1b51d5c9335cd58c8d6477db0dc058658e303f84d7019c216da77984206528d9.jpg)  
Figure 5.2: Time evolution of the global balance (black square dot line) and of the market rank indicator for $p = 3$ and $H = 1 0$ (blue kite dot line), $H = 5 0$ (red triangle dot line) and $H = 1 0 0$ (green circle dot line) for the period (a) 2005-2016 and (b) 2016-2020.

We can extend the analysis to the correlations between the AMRI and the ratio ${ \mathcal { R } } ( G )$ in Eq. (17). These correlations are very close to the previous ones. Indeed, both $\kappa ( G )$ and ${ \mathcal { R } } ( G )$ produce time series with very similar behaviors, making the two measures almost equivalent for application purposes. This fact can be explained by the presence of a large spectral gap in eigenvalues of the correlation matrices for each time window. In this case, it is possible to apply the approximate formula for the ratio in Eq. (20). This explains the almost-1 correlation between $\kappa ( G )$ and ${ \mathcal { R } } ( G )$ . We observe that the error between the exact value of the ratio in Eq. (19) and its approximate version in Eq. (20) is very small. Until October 2016, the mean relative error is $0 . 0 3 3 \%$ , with a maximum equal to $0 . 2 0 1 \%$ in August, 2015. In the period from November 2016 to January 2020, the approximation error is on average 1.22% with a max of 3.91% in October 2017. The maximum is achieved in correspondence with a severe reduction of the spectral gap in 2017, see Fig. 5.3. We also observe that the network is perfectly balanced in the windows ending in February to May 2010, which the entire year 2009.

![](images/69b435232d15199a47af06f534b65bfe6d31ad6b161eb3face45d16a66596d2d.jpg)  
Figure 5.3: Time series of the largest eigenvalues of the correlation matrix: $\lambda _ { 1 }$ in red, $\lambda _ { 1 } + \lambda _ { 2 }$ in blue and $\lambda _ { 1 } + \lambda _ { 2 } + \lambda _ { 3 }$ in green.

The previous analysis required rather long time windows due to the large number of assets in the entire dataset and the condition $T \geq N$ . This means that correlations are computed over long time intervals that do not allow local variations to be captured, implying a loss of resolution. Therefore, we repeat the previous analysis on a subset of assets from the same dataset, consisting of 50 randomly chosen assets, using 100-days time windows, always shifted by 30 days-length window. The MRI indicator has been computed using $H = 2$ , $H = 5$ and $H = 1 0$ smallest eigenvalues.

Fig. 5.4 and Fig. 5.5 show the temporal evolution of the involved quantities on the whole time interval and on the partitioned time interval, respectively.

For the selected subset of assets, we confirm the strong correlation between the Global Balance and the average correlation: $\rho _ { \mathrm { P e a r s o n } } = 0 . 6 ; 2 9 7 6 4 3$ and $\rho _ { \mathrm { S p e a r m a n } } = 0 . 8 9 1 2 2 3 5$ .

Similarly, the correlations between the Global Balance and, for instance, the MRI for $H = 2$ are $\rho _ { \mathrm { P e a r s o n } } =$ 0.5307341 and $\rho _ { \mathrm { S p e a r m a n } } = 0 . 7 6 8 5 4 5 6$ , on the period 2005-2016 and $\rho _ { \mathrm { P e a r s o n } } = 0 . 4 9 9 4 8 0 6$ and $\rho _ { \mathrm { S p e a r m a n } } =$ 0.9441659, on the period 2016-2020. The correlation between the Global Balance and the Cumulative Risk Fraction are $\rho _ { \mathrm { P e a r s o n } } ~ = ~ 0 . 9 0 9 6 7 0 8$ and $\rho _ { \mathrm { S p e a r m a n } } ~ = ~ 0 . 9 2 0 3 0 7 4$ , on the period 2005-2016 and $\rho _ { \mathrm { P e a r s o n } } =$ 0.9297902 and $\rho _ { \mathrm { S p e a r m a n } } = 0 . 9 9 1 9 7 6$ , on the period 2016-2020. To test the robustness of our findings, we repeated the exercise over many different subsets of 50 assets randomly chosen from the original index, obtaining similar results.

![](images/31d03a4fa685acaf79eee4027c0963af8379697f6b6eadb1018b614145e660e4.jpg)  
assets from S&P500 daily returns, $\Delta T = 1 0 0$ 100 and $\Delta t = 3 0$ , for the period (a) 2005-2016, (b) 2016-2020 and (c) zoom on the period 2008-2014.

![](images/e0d05de1124a2988a5e5e0b6f46b42ed58f8f98a8cd91c35a93eb75c9779956b.jpg)  
$p = 3$ and $H = 2$ (blue kite dot line), $H = 5$ (red triangle dot line) and $H = 1 0$ (green circle dot line) for the period (a) 2005-2016 and (b) 2016-2020. The figures refer to a subset of 50 assets.

We can finally conclude that there is a high correlation between the Global Balance and the considered systemic risk measures.

# 5.2. Effectiveness of the Global Balance as a systemic risk measure

We perform now an empirical analysis to assess the effectiveness of the Global Balance in detecting systemic events. In order to identify systemic events, we refer to the definition in [54]. A systemic risk event occurs if the average return of all the $N$ securities falls below a threshold $\tau$ for $\Delta T$ consecutive days. We adopt a threshold equal to $\tau = - 0 . 0 1$ or $\tau = - 0 . 0 0 5$ and sliding windows of $\Delta T = 2 0$ days.

![](images/90e9e49c5b65929d3a87fd09d535462da9e0ad74e2e302bee43c5488f90de516.jpg)  
Figure 5.6: Panel (a): Average returns of the S&P500 database in the period 2005-2020. The average returns of each asset have been computed over a 20-days-wide sliding window with 1-day step. The blue line represents the mean over all the assets in the same window of the average returns. The green and the red lines represent the maximum and the minimum, respectively, of the average returns in the same window. Panel (b) focuses on the mean of the average returns and highlight crisis events when the line goes below the two possible threshold represented by the two horizontal dashed lines.

In Fig, 5.6, panel (a), we plot the average returns of the S&P500 database from January 4, 2005 to March 18, 2020. The average returns of each asset have been computed over a 20-days-wide sliding window with 1-day step. The blue line represents the mean of the average returns over all the 385 assets in the same window. The green and the red lines represent the maximum and the minimum value, respectively, of the average returns in the same window. Panel (b) focuses on the mean of the average returns and highlight crisis events when the line goes below the two possible thresholds represented by the two horizontal dashed lines.

In this way, we can clearly identify systemic crisis events when the mean of the average returns over all the asses goes below $\tau$ , for both $\tau = - 0 . 0 0 5$ and $\tau = - 0 . 0 1 0$ . In particular, the crisis events below $\tau = - 0 . 0 1 0$ ranges in the time intervals September-November 2008, February 2009, July 2011, October 2019.

We study the joint distribution of the average returns and of the global balance in the sliding windows. The range of the indicator $\kappa ( G )$ has been divided into $n$ bins $B _ { 1 } , B _ { 2 } , \ldots , B _ { n }$ and the conditional distributions of the average returns $P \left( \langle X _ { i t } \rangle | \kappa ( G ) \in B _ { k } \right)$ have been computed on each bin. Specifically, in a first experiment the interval $[ 0 , 1 ]$ is divided into 5 bins of equal width while, in a second scenario, the five intervals are $( 0 , 0 . 5 ]$ , (0.5, 0.8], (0.8, 0.9], (0.9, 0.99] and (0.99, 1.00]. The necessity of testing what happens with intervals of different lengths, very small when close to 1, is a peculiarity in the framework of systemic risk. Since systemic risk are, hopefully, rare compared to the periods in which the market behaves normally, a systemic risk indicator should discriminate a few events within a multitude.

![](images/1684703fd61c3812c869c0f0b9702585f9e111dc08ae9bdd4c684c90a0990684.jpg)  
Figure 5.7: Conditional distributions of the $2 0 -$ days average returns with respect to the value of $\kappa ( G )$ , for the whole network of 385 assets. In panels (a) and (b), the densities are computed on the weighted version of the correlations networks, while, in panels (c) and (d), the densities are computed on the binary version of the correlation networks. Panels (a) and (c) refer to equal width intervals and panels (b) and (d) to the partition described in the text.

Figure 5.7 displays the densities of the average returns conditioned to the values of $\kappa ( G )$ , obtained by using a Gaussian kernel smoothing for the whole dataset of 385 assets (panels (a) and (b) for the weighted version of the correlation networks and panels (c) and (d) for the binary version). When $\kappa ( G )$ increases, the densities move leftwards and flatten. More precisely, three effects can be recognized in relation to the increase of $\kappa ( G )$ : the average of the conditional distribution decreases; the standard deviation increases; the $\mathrm { V a R ^ { 5 } }$ of the average returns increases.

Fig. 5.8 shows the boxplots of the same distributions conditioned on the two different partitions of the $[ 0 , 1 ]$ interval for the global balance in the weighted and binary version. The mean of the average returns within each interval decreases as $\kappa ( G )$ increases, while the standard deviation increases. This is particularly noticeable by considering the extreme intervals in Fig. 5.8, panels (b) and (d), which refer to the events in the interval $\kappa ( G ) \in ( 0 . 9 9 , 1 . 0 0 ]$ .

The values of the mean of the conditional distributions in Fig. 5.8 are collected in Table 5.2, while Table 5.3 reports the values of the means computed for the smoothed distributions in Fig. 5.7. Both are characterized by a strictly negative monotonic behavior as $\kappa ( G )$ increases.

<table><tr><td rowspan=1 colspan=1></td><td rowspan=1 colspan=5>Mean of the average returns</td></tr><tr><td rowspan=1 colspan=1>Interval</td><td rowspan=1 colspan=1>0 &lt; κ(G) ≤ 0.2</td><td rowspan=1 colspan=1>0.2 &lt; κ(G) ≤ 0.4</td><td rowspan=1 colspan=1>0.4 &lt; κ(G) ≤ 0.6</td><td rowspan=1 colspan=1>0.6 &lt; κ(G) ≤ 0.8</td><td rowspan=1 colspan=1>0.8 &lt; κ(G) ≤ 1.0</td></tr><tr><td rowspan=1 colspan=1>Weighted</td><td rowspan=1 colspan=1>0.0007890292</td><td rowspan=1 colspan=1>0.0002017107</td><td rowspan=1 colspan=1>−0.00008924373</td><td rowspan=1 colspan=1>−0.00009901411</td><td rowspan=1 colspan=1>−0.002686201</td></tr><tr><td rowspan=1 colspan=1>Binary</td><td rowspan=1 colspan=1>0.0008529778</td><td rowspan=1 colspan=1>0.0002181775</td><td rowspan=1 colspan=1>0.00006867374</td><td rowspan=1 colspan=1>-0.0004070862</td><td rowspan=1 colspan=1>−0.00202211</td></tr><tr><td rowspan=1 colspan=1>Interval</td><td rowspan=1 colspan=1>0 &lt; κ(G) ≤ 0.5</td><td rowspan=1 colspan=1>0.5 &lt; κ(G) ≤ 0.8</td><td rowspan=1 colspan=1>0.8 &lt; κ(G) ≤ 0.9</td><td rowspan=1 colspan=1>0.9 &lt; κ(G) ≤ 0.99</td><td rowspan=1 colspan=1>0.99 &lt; κ(G) ≤ 1.0</td></tr><tr><td rowspan=1 colspan=1>Weighted</td><td rowspan=1 colspan=1>0.0006679086</td><td rowspan=1 colspan=1>−0.00009905363</td><td rowspan=1 colspan=1>−0.001337312</td><td rowspan=1 colspan=1>−0.003448823</td><td rowspan=1 colspan=1>−0.004218843</td></tr><tr><td rowspan=1 colspan=1>Binary</td><td rowspan=1 colspan=1>0.0007200273</td><td rowspan=1 colspan=1>−0.0002525449</td><td rowspan=1 colspan=1>−0.001012558</td><td rowspan=1 colspan=1>−0.002203236</td><td rowspan=1 colspan=1>−0.003917621</td></tr></table>

Table 5.2: Mean of the average returns in the different balance bands. Weighted and binary refer to the two versions of the correlation networks.

<table><tr><td rowspan=1 colspan=1></td><td rowspan=1 colspan=5>Mean of the smoothed conditional distributions</td></tr><tr><td rowspan=1 colspan=1>Interval</td><td rowspan=1 colspan=1>0 &lt; κ(G) ≤ 0.2</td><td rowspan=1 colspan=1>0.2 &lt; κ(G) ≤ 0.4</td><td rowspan=1 colspan=1>0.4 &lt; κ(G) ≤ 0.6</td><td rowspan=1 colspan=1>0.6 &lt; κ(G) ≤ 0.8</td><td rowspan=1 colspan=1>0.8 &lt; κ(G) ≤ 1.0</td></tr><tr><td rowspan=1 colspan=1>Weighted</td><td rowspan=1 colspan=1>0.001228899</td><td rowspan=1 colspan=1>0.001604856</td><td rowspan=1 colspan=1>0.0006486389</td><td rowspan=1 colspan=1>−0.001496206</td><td rowspan=1 colspan=1>−0.005628693</td></tr><tr><td rowspan=1 colspan=1>Binary</td><td rowspan=1 colspan=1>0.001228899</td><td rowspan=1 colspan=1>0.00232083</td><td rowspan=1 colspan=1>0.001939107</td><td rowspan=1 colspan=1>-0.001496206</td><td rowspan=1 colspan=1>−0.005628693</td></tr><tr><td rowspan=1 colspan=1>Interval</td><td rowspan=1 colspan=1>0 &lt; κ(G) ≤ 0.5</td><td rowspan=1 colspan=1>0.5 &lt; κ(G) ≤ 0.8</td><td rowspan=1 colspan=1>0.8 &lt; κ(G) ≤ 0.9</td><td rowspan=1 colspan=1>0.9 &lt; κ(G) ≤ 0.99</td><td rowspan=1 colspan=1>0.99 &lt; κ(G) ≤ 1.0</td></tr><tr><td rowspan=1 colspan=1>Weighted</td><td rowspan=1 colspan=1>0.001604856</td><td rowspan=1 colspan=1>-0.001496206</td><td rowspan=1 colspan=1>−0.003188417</td><td rowspan=1 colspan=1>−0.00783892</td><td rowspan=1 colspan=1>-0.00977485</td></tr><tr><td rowspan=1 colspan=1>Binary</td><td rowspan=1 colspan=1>0.001604856</td><td rowspan=1 colspan=1>−0.001496206</td><td rowspan=1 colspan=1>−0.005236051</td><td rowspan=1 colspan=1>−0.005628693</td><td rowspan=1 colspan=1>−0.009021566</td></tr></table>

Table 5.3: Mean of the average returns in the different balance bands. Weighted and binary refer to the two versions of the correlation networks.

Finally, we computed the VaR within each band. For instance, for the whole network in the weighted version and with intervals of equal width the VaR’s are: 0.02384863 for $0 < \kappa ( G ) \leq 0 . 2$ ; 0.0281525, for $0 . 2 < \kappa ( G ) \leq 0 . 4$ ; 0.03010301, for $0 . 4 < \kappa ( G ) \leq 0 . 6$ ; 0.03521984, for $0 . 6 < \kappa ( G ) \leq 0 . 8$ ; and 0.05100622 for $0 . 8 < \kappa ( G ) \leq 1 . 0$ .

![](images/64e4feb9fc56892ee09fb16a68dbc5aac479c8771e5c0e8f90ec86fc97661ce4.jpg)  
Figure 5.8: Boxplots for the $2 0 -$ days average returns conditioned on the value of $\kappa ( G )$ , for the whole network of 385 assets. Panels (a) and (b) refer to the weighted version of the correlations networks, while panels (c) and (d) to the binary version of the correlations networks. Panels (a) and (c) refer to equal width intervals and panels (b) and (d) to the partition described in the text.

This evidence shows that the global balance is a meaningful systemic risk measure. Indeed, a large value of $\kappa ( G )$ signals that the market is experiencing worse performance and that the probability of big losses is high.

Finally, we check the robustness of our findings using a different data set. We refer to the constituents of the eurostoxx 50 index (ESX50). The cleaned dataset contains the daily returns of 42 stocks from January 5, 2005 to September 17, 2020. We perform the test over windows of 45 days. In Fig. 5.9 we plot the mean, maximum and minimum average returns of the constituents, panel (a), and a zoom on the mean, panel (b). Due to the larger size of the time windows, we detect less but more severe events. In this new European dataset, we specifically identify the systemic crisis associated with COVID-19 in January 2020 with a threshold $\tau = - 0 . 0 1 0$ . Similarly to the previous database, Fig. 5.10 and Table 5.4 illustrate the conditional smoothed distributions, the boxplots and the corresponding mean values for the weighted version of the correlation networks. We do not show the results for the binary network for the present example. The numerical results confirm the previous findings, reinforcing the interpretation of the global balance as an effective systemic risk indicator.

![](images/69a88d772fb5295b32ab31df62887498d891304595fd77e217b95ad385a92233.jpg)  
Figure 5.9: Panel (a): Average returns of the eurostoxx 50 index (ESX50) in the period 2005-2020. The average returns of each asset have been computed over a 20-days-wide sliding window with step 1 day. The blue line represents the mean over all the assets in the same window of the average returns. The green and the red lines represent the max and the min, respectively, of the average returns in the same window. Panel (b) focuses on the mean of the average returns and highlight crisis events when the line goes below the two possible threshold represented by the two horizontal dashed lines.

![](images/892097f7b74e50b7c0af6be485f3d331032fa45364467f98a39b0014ff095922.jpg)  
Figure 5.10: Densities, panel (a), and boxplot, panel (b), of the conditional distributions of the mean average returns of the 42 constituents of the ESX dataset.

Table 5.4: Mean of the real average returns (mean values) and mean of the smoothed densities (mean density) in the different balance bands for the ESX dataset in the weighted version of the correlation networks.   

<table><tr><td rowspan=1 colspan=1>Interval</td><td rowspan=1 colspan=1>0 &lt; κ(G) ≤ 0.5</td><td rowspan=1 colspan=1>0.5 &lt; κ(G) ≤ 0.8</td><td rowspan=1 colspan=1>0.8 &lt; κ(G) ≤ 0.9</td><td rowspan=1 colspan=1>0.9 &lt; κ(G) ≤ 0.99</td><td rowspan=1 colspan=1>0.99 &lt; κ(G) ≤ 1.0</td></tr><tr><td rowspan=1 colspan=1>Mean density</td><td rowspan=1 colspan=1>0.001932035</td><td rowspan=1 colspan=1>0.000561916</td><td rowspan=1 colspan=1>0.0004691143</td><td rowspan=1 colspan=1>-0.0006158585</td><td rowspan=1 colspan=1>-0.002433815</td></tr><tr><td rowspan=1 colspan=1>Mean values</td><td rowspan=1 colspan=1>0.001999696</td><td rowspan=1 colspan=1>0.0008673605</td><td rowspan=1 colspan=1>0.000616936</td><td rowspan=1 colspan=1>0.0004399794</td><td rowspan=1 colspan=1>-0.0003903168</td></tr></table>

# 6. Conclusion

This paper provides a bridge between the realm of balance in signed networks and that of systemic risk measures for asset correlation networks. The link within the two frameworks is built through the definition of a discrete diffusive process that drives the spread of the information on the network. On the one side, the process permits to derive the global balance indicator in an alternative way with respect to the standard combinatoric approach. On the other side, the steady state of the diffusive process is the solution of a linear system where the coefficients are the elements of the exponential matrix. Then the relation between the condition number of the exponential matrix and the global balance of the network follows in a straightforward way. The structural predictability of a network refers to the monotone behavior of the nodes in response to a perturbation at one or more nodes, and is equivalent to the numerical stability of a linear system. We prove interesting properties that shed light on the relationship between the global balance and the condition numbers of the signed and unsigned problems. We also introduce an almost complete characterization of signed networks that consider the number of possible odd/even positive/negative closed walks. By replacing the adjacency matrix with the correlation matrix of financial returns, we apply the global balance index to systemic risk detection. This step is natural considering that there exists a whole class of systemic risk measures proposed in the literature that are generalizations of the condition number of the correlation matrix. The application on two different databases of real financial data supports and confirms our idea. The global balance of the correlation network can be used as a systemic risk indicator. The main advantage of this approach is that it does not require a full rank correlation matrix. Consequently, the global balance of the correlation network can be calculated also when the number of observations is smaller than the number of the financial assets. This scenario is of great interest in the framework of systemic risk for two main reasons. First, ideally the number of securities constituting a good approximation of the whole financial index is supposed to be very large, and our methodology allows to deal with a large number of assets. Second, our approach allows to work with short estimation windows containing only more recent data, which are necessary to obtain a systemic risk measure with a good descriptive content and a potential predictive power. There is one further advantage that characterizes our proposal. The global balance indicator is naturally obtained as the aggregation of the local balance indices. Hence, these local indices measure the contribution of the single node in the correlation network to the global balance. While standard approaches to systemic risk usually measures the overall risk of the economic system, the approach of the balance is basically local. Our future research will focus on the local balance to investigate the role of each asset to the general stability of the market.

# Acknowledgements:

FDD thanks financial support from MDM-2017-0711-20-2 funded by MCIN/AEI/10.13039/501100011033 and FSE, as well as project APASOS (No. PID2021-122256NB-C22

# References

[1] S. Giglio, B. Kelly, S. Pruitt, Systemic risk and the macroeconomy: An empirical evaluation, Journal of Financial Economics 119 (3) (2016) 457–471.   
[2] F. X. Diebold, K. Yılmaz, On the network topology of variance decompositions: Measuring the connectedness of financial firms, Journal of Econometrics 182 (1) (2014) 119–134.   
[3] M. Demirer, F. X. Diebold, L. Liu, K. Yilmaz, Estimating global bank network connectedness, Journal of Applied Econometrics 33 (1) (2018) 1–15.   
[4] T. Adrian, M. K. Brunnermeier, Covar, Tech. rep., National Bureau of Economic Research (2011).   
[5] L. Laeven, L. Ratnovski, H. Tong, Bank size, capital, and systemic risk: Some international evidence, Journal of Banking & Finance 69 (2016) S25–S34.   
[6] O. Bernal, J.-Y. Gnabo, G. Guilmin, Assessing the contribution of banks, insurance and other financial services to systemic risk, Journal of Banking & Finance 47 (2014) 270–287.   
[7] G. L´opez-Espinosa, A. Moreno, A. Rubia, L. Valderrama, Short-term wholesale funding and systemic risk: A global covar approach, Journal of Banking & Finance 36 (12) (2012) 3150–3162.   
[8] I. Aldasoro, I. Alves, Multiplex interbank networks and systemic importance: An application to european data, Journal of Financial Stability 35 (2018) 17–37.   
[9] D. Bisias, M. Flood, A. W. Lo, S. Valavanis, A survey of systemic risk analytics, Annual Reviews of Financial Economics 4 (1) (2012) 255–296.   
[10] M. Rodr´ıguez-Moreno, J. I. Pe˜na, Systemic risk measures: The simpler the better?, Journal of Banking & Finance 37 (6) (2013) 1817–1831.   
[11] W. Silva, H. Kimura, V. A. Sobreiro, An analysis of the literature on systemic financial risk: A survey, Journal of Financial Stability 28 (2017) 91–114.   
[12] M. Billio, M. Getmansky, A. W. Lo, L. Pelizzon, Econometric measures of connectedness and systemic risk in the finance and insurance sectors, Journal of Financial Economics 104 (3) (2012) 535–559, market Institutions, Financial Market Risks and Financial Crisis.   
[13] Z. Zheng, B. Podobnik, L. Feng, B. Li, Changes in cross-correlations as an indicator for systemic risk, Scientific Reports 2 (1) (2012) 1–8.   
[14] D. Zhang, D. C. Broadstock, Global financial crisis and rising connectedness in the international commodity markets, International Review of Financial Analysis 68 (2020) 101239.   
[15] R. N. Mantegna, Hierarchical structure in financial markets, The European Physical Journal B - Condensed Matter and Complex Systems 11 (1999) 193–197.   
[16] J.-B. Hasse, Systemic risk: a network approach, AMSE Working Papers 63 (2025) (2020) 313–344.   
[17] F. Harary, On the notion of balance of a signed graph., Michigan Mathematical Journal 2 (2) (1953) 143–146.   
[18] D. Cartwright, F. Harary, Structural balance: a generalization of heider’s theory., Psychological review 63 (5) (1956) 277.   
[19] A. Kirkley, G. T. Cantwell, M. E. J. Newman, Balance in signed networks, Phys. Rev. E 99 (2019) 012320.   
[20] G. Facchetti, G. Iacono, C. Altafini, Computing global structural balance in large-scale signed social networks, Proceedings of the National Academy of Sciences 108 (52) (2011) 20953–20958.   
[21] A. Gallo, D. Garlaschelli, R. Lambiotte, F. Saracco, T. Squartini, Testing structural balance theories in heterogeneous signed networks, Commun Phys 7 (154) (2024).   
[22] J. Kunegis, S. Schmidt, A. Lommatzsch, J. Lerner, E. W. D. Luca, S. Albayrak, Spectral Analysis of Signed Graphs for Clustering, Prediction and Visualization, SIAM, 2010.   
[23] E. Estrada, M. Benzi, Walk-based measure of balance in signed networks: Detecting lack of balance in social networks, Physical review. E, Statistical, nonlinear, and soft matter physics 90 (2014) 042802.   
[24] S. Aref, M. C. Wilson, Measuring partial balance in signed networks, Journal of Complex Networks 6 (4) (2017) 566–595.   
[25] S. Talaga, M. Stella, T. J. Swanson, A. S. Teixeira, Polarization and multiscale structural balance in signed networks, Commun Phys 6 (349) (2023).   
[26] C. Altafini, Consensus problems on networks with antagonistic interactions, Automatic Control, IEEE Transactions on 58 (2013) 935–946.   
[27] Y. W. Yanhua Li, Wei Chen, Z.-L. Zhang, Voter model on signed social networks, Internet Mathematics 11 (2) (2015) 93–133.   
[28] M. T. Schaub, N. O’Clery, Y. N. Billeh, J.-C. Delvenne, R. Lambiotte, M. Barahona, Graph partitions and cluster synchronization in networks of oscillators, Chaos: An Interdisciplinary Journal of Nonlinear Science 26 (9) (2016) 094821.   
[29] P. Fan, H. Wang, P. Li, W. Li, Z. Jiang, Analysis of opinion spreading in homogeneous networks with signed relationships, Journal of Statistical Mechanics: Theory and Experiment 2012 (08) (2012) P08003.   
[30] K.-M. Lee, S. Lee, B. Min, K.-I. Goh, Threshold cascade dynamics on signed random networks, Chaos, Solitons & Fractals 168 (2023) 113118.   
[31] A. Vendeville, F. Diaz-Diaz, Echo chamber effects in signed networks (2024). arXiv:2406.17435.   
[32] Z. P. Neal, A sign of the times? weak and strong polarization in the u.s. congress, 1973–2016, Social Networks 60 (2020) 103–112, social Network Research on Negative Ties and Signed Graphs.   
[33] F. Emma, P. Max, S. Simon, G. Vicen¸c, G. David, Unpacking polarization: Antagonism and alignment in signed networks of online interaction, ArXiv (07 2023).   
[34] F. Diaz-Diaz, E. Estrada, Signed graphs in data sciences via communicability geometry (2024). arXiv: 2403.07493.   
[35] M. Ruiz-Garc´ıa, J. Ozaita, M. Pereda, A. Alfonso, P. Bra˜nas-Garza, J. A. Cuesta, A. S´anchez, Triadic influence as a proxy for compatibility in social relationships, Proceedings of the National Academy of Sciences 120 (13) (2023) e2215041120.   
[36] F. Diaz-Diaz, P. Bartesaghi, E. Estrada, Mathematical modeling of local balance in signed networks and its applications to global international analysis (2024). arXiv:2303.03774.   
[37] T. Zaslavsky, Signed graphs, Discrete Applied Mathematics 4 (1) (1982) 47–74.   
[38] F. Harary, M. Lim, D. C. Wunsch, Signed graphs for portfolio analysis in risk management, IMA Journal of Management Mathematics 13 (3) (2002) 201–210.   
[39] S. Figini, M. Maggi, P. Uberti, The market rank indicator to detect financial distress, Econometrics and Statistics 14 (2020) 63–73.   
[40] D. McDonald, L. Waterbury, R. Knight, M. D. Betterton, Activating and inhibiting connections in biological network dynamics, Biology Direct 3 (49) (2008).   
[41] S. Galam, Fragmentation versus stability in bimodal coalitions, Physica A: Statistical Mechanics and its Applications 230 (1) (1996) 174–188.   
[42] S. G. Pandey, A model of signed network formation with heterogeneous players, Research in Economics 75 (1) (2021) 119–128.   
[43] E. Ferreira, S. Orbe, J. Ascorbebeitia, B. Alvarez Pereira, E. Estrada, Loss of structural balance in stock markets, Scientific Reports 11 (2021) 1–10.   
[44] F. Harary, Structural duality, Behavioral Science 2 (4) (1957) 255–265.   
[45] T. Zaslavsky, Matrices in the theory of signed simple graphs, Advances in Discrete Mathematics and Applications: Mysore, 2008 (ICDM-2008, Mysore, India) 13 (03 2013).   
[46] Y. Tian, R. Lambiotte, Spreading and structural balance on signed networks, SIAM Journal on Applied Dynamical Systems 23 (1) (2024) 50–80.   
[47] R. Ghosh, K. Lerman, T. Surachawala, K. Voevodski, S. Teng, Non-conservative diffusion and its application to social network analysis, Journal of Complex Networks 12 (1) (2024) cnae006.   
[48] B. D. Acharya, Spectral criterion for cycle balance in networks, Journal of Graph Theory 4 (1) (1980) 1–11.   
[49] G. H. Golub, C. F. Van Loan, Matrix computations, JHU press, 2013.   
[50] F. Belardo, S. M. Cioab˘a, J. H. Koolen, J. Wang, Open problems in the spectral theory of signed graphs, arXiv preprint arXiv:1907.04349 (2019).   
[51] A. Meucci, Managing diversification, Risk 22 (2010) 74–79.   
[52] D. Jonsson, Some limit theorems for the eigenvalues of a sample covariance matrix, Journal of Multivariate Analysis 12 (1) (1982) 1–38.   
[53] M. Maggi, M. Torrente, P. Uberti, Proper measures of connectedness, Annals of Finance 16 (2020) 547–571.   
[54] C. Pastorino, P. Uberti, An empirical comparison of correlation-based systemic risk measures, Quality & Quantity 2023/09/23 (2023).   
[55] S. Manganelli, R. Engle, Value at risk models in finance, SSRN Electronic Journal (09 2001).

# Appendix A. Results for random correlation matrices

We provide here some exact results on the asymptotic behavior of the sums in Eq. (19) in the case of purely random correlation matrices. Specifically, we prove two analytical results about the two sums involved in the condition number on the signed network $G$ , that is $\begin{array} { r } { \mathcal { H } ( e ^ { - \mathbf { A } } ) = \left( \sum _ { j = 1 } ^ { N } e ^ { - \lambda _ { j } } \right) \left( \sum _ { j = 1 } ^ { N } e ^ { \lambda _ { j } } \right) } \end{array}$ for independent normal variables $\ddot { X } _ { i t }$ with zero mean and unit variance.

Proposition 6. Let $\ddot { X } _ { i t }$ be independent normal variables with zero mean and unit variance and let $\lambda _ { 1 } >$ $\cdots > \lambda _ { n } > 0$ the eigenvalues of their correlation matrix $\mathbf { C }$ . Then, for $N \to + \infty$ , $T \to + \infty$ , $N / T \to 1$

$$
\sum _ { i = 1 } ^ { N } e ^ { \lambda _ { i } } \sim I _ { 2 } ( 2 ) e ^ { 2 } N \sim 5 . 0 9 0 6 7 9 N
$$

and

$$
\sum _ { i = 1 } ^ { N } e ^ { - \lambda _ { i } } \sim \frac { I _ { 0 } ( 2 ) + I _ { 1 } ( 2 ) } { e ^ { 2 } } N \sim 0 . 5 2 3 7 7 8 N
$$

where $\begin{array} { r } { I _ { n } ( z ) = \left( \frac { z } { 2 } \right) ^ { n } \sum _ { k = 0 } ^ { \infty } \frac { \left( \frac { z ^ { 2 } } { 4 } \right) ^ { k } } { k ! \Gamma ( n + k + 1 ) } } \end{array}$ are the modified Bessel functions of the first kind.

Proof. The $k -$ moment $M _ { k }$ of the graph $G$ shows the following asymptotic behavior (see [52])

$$
M _ { k } = { \frac { 1 } { N } } \sum _ { i = 1 } \lambda _ { i } ^ { k } \sim { \binom { 2 k } { k } } { \frac { 1 } { k + 1 } } = { \frac { ( 2 k ) ! } { k ! ( k + 1 ) ! } }
$$

Then we have

$$
\begin{array} { c } { { \displaystyle \sum _ { i = 1 } ^ { N } e ^ { - \lambda _ { i } } = \sum _ { i = 1 } ^ { N } \sum _ { k = 0 } ^ { \infty } ( - 1 ) ^ { k } \frac { 1 } { k ! } \lambda _ { i } ^ { k } = \sum _ { k = 0 } ^ { \infty } ( - 1 ) ^ { k } \frac { 1 } { k ! } \sum _ { i = 1 } ^ { N } \lambda _ { i } ^ { k } } } \\ { { = N \sum _ { k = 0 } ^ { \infty } ( - 1 ) ^ { k } \frac { 1 } { k ! } M _ { k } = N \sum _ { k = 0 } ^ { \infty } ( - 1 ) ^ { k } \frac { 1 } { k ! } \frac { ( 2 k ) ! } { k ! ( k + 1 ) ! } } } \\ { { = N \sum _ { k = 0 } ^ { \infty } ( - 1 ) ^ { k } \frac { ( 2 k ) ! } { ( k ! ) ^ { 3 } ( k + 1 ) } = N \frac { I _ { 0 } ( 2 ) + I _ { 1 } ( 2 ) } { e ^ { 2 } } } } \end{array}
$$

As a consequence, the condition number grows, under these assumptions, as $2 . 6 7 N ^ { 2 }$ , that is $\mathcal { H } ( e ^ { - \mathbf { A } } ) \sim$ $O ( N ^ { 2 } )$ . A similar result can hardly be replicated for the absolute value matrix, i.e., for the network $| G |$ . Nonetheless, we can investigate the statistical correlation between the ratio of the two condition numbers $\mathcal { R } ( \mathbf { A } ) = \mathcal { H } ( e ^ { - \mathbf { A } } ) / \mathcal { H } ( e ^ { - | \mathbf { A } | } )$ and the global balance $\kappa ( G )$ . In particular, we generate random correlation matrices $_ 6$ of increasing size $N = 5$ , $N = 1 0$ , $N = 2 0$ , $N = 5 0$ , and we consider for each dimension 100 repetitions. In Fig. A.1, we report the scatterplot of the values of $\mathcal { R } ( { \bf A } )$ and $\kappa ( G )$ . As can be seen, the values of the two indicators correlate very strongly and increasingly as the network size, i.e. the number of assets involved, increases.

![](images/5620972605a3ffd5c4e7c8094a92a06892ba1b552054ebe7cd95284a3a081602.jpg)  
Figure A.1: Increasing correlation between the ratio $\mathcal { R } ( { \bf A } )$ and the global balance $\kappa ( G )$ for (a) $N = 5$ , $\rho = 0 . 8 5 4 6 6 3 3$ (b) $N = 1 0$ , $\rho = 0 . 9 6 9 3 8 1 7$ , (c) $N = 2 0$ , $\rho = 0 . 9 9 1 8 8 8 8$ , (d) $N = 5 0$ , $\rho = 0 . 9 9 8 4 1 2 3$